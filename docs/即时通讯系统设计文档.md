# GameLinkå³æ—¶é€šè®¯ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **é¡¹ç›®åç§°**: GameLinkå³æ—¶é€šè®¯ç³»ç»Ÿ
- **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
- **åˆ›å»ºæ—¥æœŸ**: 2025-11-10
- **è´Ÿè´£äºº**: é¡¹ç›®å¼€å‘å›¢é˜Ÿ
- **æ–‡æ¡£ç±»å‹**: æŠ€æœ¯è®¾è®¡æ–‡æ¡£

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®èƒŒæ™¯
GameLinkä½œä¸ºä¸€ä¸ªç°ä»£åŒ–çš„é™ªç©ç®¡ç†å¹³å°ï¼Œå³æ—¶é€šè®¯åŠŸèƒ½æ˜¯æå‡ç”¨æˆ·ä½“éªŒå’Œè¿è¥æ•ˆç‡çš„æ ¸å¿ƒåŠŸèƒ½ã€‚æœ¬ç³»ç»Ÿæ—¨åœ¨ä¸ºç”¨æˆ·ã€é™ªç©å¸ˆå’Œå®¢æœæä¾›å®æ—¶æ²Ÿé€šæ¸ é“ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹è®¢å•æœåŠ¡çš„ä¸‰äººå°ç¾¤åŠŸèƒ½ã€‚

### æ ¸å¿ƒéœ€æ±‚
1. **å…¬å…±èŠå¤©ç¾¤**: æ‰€æœ‰æ™®é€šç”¨æˆ·å¯å‚ä¸çš„å…¬å…±èŠå¤©å®¤
2. **è®¢å•å°ç¾¤**: å®¢æœ+æ‰“æ‰‹+ç”¨æˆ·çš„ä¸‰äººç¾¤ç»„ï¼Œè®¢å•ç»“æŸåè‡ªåŠ¨é”€æ¯
3. **å®æ—¶é€šä¿¡**: åŸºäºWebSocketçš„å®æ—¶æ¶ˆæ¯æ¨é€
4. **æ¶ˆæ¯ç±»å‹**: æ”¯æŒæ–‡å­—å’Œå›¾ç‰‡æ¶ˆæ¯
5. **æ¶ˆæ¯æŒä¹…åŒ–**: å®Œæ•´çš„èŠå¤©è®°å½•å­˜å‚¨å’ŒæŸ¥è¯¢

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯å®¢æˆ·ç«¯     â”‚    â”‚   WebSocketæœåŠ¡  â”‚    â”‚   ä¸šåŠ¡æœåŠ¡       â”‚
â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
â”‚ â€¢ èŠå¤©ç•Œé¢      â”‚â—„â”€â”€â–ºâ”‚ â€¢ è¿æ¥ç®¡ç†      â”‚â—„â”€â”€â–ºâ”‚ â€¢ ç¾¤ç»„ç®¡ç†      â”‚
â”‚ â€¢ æ¶ˆæ¯å±•ç¤º      â”‚    â”‚ â€¢ æ¶ˆæ¯è·¯ç”±      â”‚    â”‚ â€¢ æƒé™æ§åˆ¶      â”‚
â”‚ â€¢ å®æ—¶é€šçŸ¥      â”‚    â”‚ â€¢ çŠ¶æ€åŒæ­¥      â”‚    â”‚ â€¢ è®¢å•ç›‘å¬      â”‚
â”‚ â€¢ å›¾ç‰‡ä¸Šä¼       â”‚    â”‚ â€¢ å¿ƒè·³æ£€æµ‹      â”‚    â”‚ â€¢ è‡ªåŠ¨åŒ–æµç¨‹    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   æ•°æ®å­˜å‚¨å±‚     â”‚
                       â”‚                â”‚
                       â”‚ â€¢ MySQLæ•°æ®åº“   â”‚
                       â”‚ â€¢ Redisç¼“å­˜     â”‚
                       â”‚ â€¢ æ–‡ä»¶å­˜å‚¨      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆé€‰æ‹©
- **åç«¯**: Go 1.25.3 + Gin + GORM + WebSocket
- **å‰ç«¯**: React 18 + TypeScript + WebSocket API
- **æ•°æ®åº“**: MySQL (ä¸»åº“) + Redis (ç¼“å­˜)
- **æ–‡ä»¶å­˜å‚¨**: æœ¬åœ°å­˜å‚¨ + CDNåˆ†å‘

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ•°æ®è¡¨ç»“æ„

#### 1. èŠå¤©ç¾¤ç»„è¡¨ (chat_groups)
```sql
CREATE TABLE chat_groups (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    group_name VARCHAR(128) NOT NULL,                    -- ç¾¤ç»„åç§°
    group_type ENUM('public', 'order') NOT NULL,        -- ç¾¤ç»„ç±»å‹ï¼šå…¬å…±ç¾¤/è®¢å•ç¾¤
    related_order_id BIGINT NULL,                       -- å…³è”è®¢å•IDï¼ˆè®¢å•ç¾¤ä¸“ç”¨ï¼‰
    created_by BIGINT NOT NULL,                         -- åˆ›å»ºè€…ID
    max_members INT DEFAULT 100,                        -- æœ€å¤§æˆå‘˜æ•°
    is_active BOOLEAN DEFAULT TRUE,                     -- æ˜¯å¦æ´»è·ƒ
    auto_destroy BOOLEAN DEFAULT FALSE,                 -- æ˜¯å¦è‡ªåŠ¨é”€æ¯
    settings JSON NULL,                                 -- ç¾¤ç»„é…ç½®
    avatar_url VARCHAR(255) NULL,                       -- ç¾¤å¤´åƒ
    description TEXT NULL,                              -- ç¾¤æè¿°
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_group_type (group_type),
    INDEX idx_related_order (related_order_id),
    INDEX idx_created_by (created_by),
    INDEX idx_is_active (is_active),
    FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (related_order_id) REFERENCES orders(id) ON DELETE CASCADE
);
```

#### 2. ç¾¤ç»„æˆå‘˜è¡¨ (chat_group_members)
```sql
CREATE TABLE chat_group_members (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    group_id BIGINT NOT NULL,
    user_id BIGINT NOT NULL,
    role ENUM('owner', 'admin', 'member') DEFAULT 'member', -- ç¾¤å†…è§’è‰²
    nickname VARCHAR(64) NULL,                            -- ç¾¤å†…æ˜µç§°
    joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_read_at TIMESTAMP NULL,                          -- æœ€åé˜…è¯»æ—¶é—´
    last_read_message_id BIGINT NULL,                     -- æœ€åé˜…è¯»çš„æ¶ˆæ¯ID
    is_muted BOOLEAN DEFAULT FALSE,                       -- æ˜¯å¦é™éŸ³
    is_active BOOLEAN DEFAULT TRUE,                       -- æ˜¯å¦æ´»è·ƒ

    UNIQUE KEY uk_group_user (group_id, user_id),
    INDEX idx_user_id (user_id),
    INDEX idx_joined_at (joined_at),
    FOREIGN KEY (group_id) REFERENCES chat_groups(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

#### 3. æ‰©å±•æ¶ˆæ¯è¡¨ (chat_messages)
```sql
CREATE TABLE chat_messages (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    group_id BIGINT NOT NULL,
    sender_id BIGINT NOT NULL,
    content TEXT NOT NULL,
    message_type ENUM('text', 'image', 'file', 'system') DEFAULT 'text',
    reply_to_id BIGINT NULL,                             -- å›å¤æ¶ˆæ¯ID
    image_url VARCHAR(255) NULL,                         -- å›¾ç‰‡URLï¼ˆå›¾ç‰‡æ¶ˆæ¯ä¸“ç”¨ï¼‰
    image_size INT NULL,                                 -- å›¾ç‰‡å¤§å°ï¼ˆå­—èŠ‚ï¼‰
    image_width INT NULL,                                -- å›¾ç‰‡å®½åº¦
    image_height INT NULL,                               -- å›¾ç‰‡é«˜åº¦
    is_deleted BOOLEAN DEFAULT FALSE,                    -- æ˜¯å¦å·²åˆ é™¤
    edit_count INT DEFAULT 0,                            -- ç¼–è¾‘æ¬¡æ•°
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_group_id_created (group_id, created_at DESC),
    INDEX idx_sender_id (sender_id),
    INDEX idx_reply_to (reply_to_id),
    INDEX idx_message_type (message_type),
    FOREIGN KEY (group_id) REFERENCES chat_groups(id) ON DELETE CASCADE,
    FOREIGN KEY (sender_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (reply_to_id) REFERENCES chat_messages(id) ON DELETE SET NULL
);
```

#### 4. ç”¨æˆ·åœ¨çº¿çŠ¶æ€è¡¨ (user_online_status)
```sql
CREATE TABLE user_online_status (
    user_id BIGINT PRIMARY KEY,
    is_online BOOLEAN DEFAULT FALSE,
    last_active_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    socket_id VARCHAR(128) NULL,                         -- WebSocketè¿æ¥ID
    current_group_id BIGINT NULL,                        -- å½“å‰æ‰€åœ¨ç¾¤ç»„
    device_info JSON NULL,                               -- è®¾å¤‡ä¿¡æ¯
    ip_address VARCHAR(45) NULL,                         -- IPåœ°å€

    INDEX idx_is_online (is_online),
    INDEX idx_last_active (last_active_at),
    INDEX idx_socket_id (socket_id),
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (current_group_id) REFERENCES chat_groups(id) ON DELETE SET NULL
);
```

#### 5. ç¾¤ç»„é‚€è¯·è®°å½•è¡¨ (chat_group_invitations)
```sql
CREATE TABLE chat_group_invitations (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    group_id BIGINT NOT NULL,
    inviter_id BIGINT NOT NULL,                          -- é‚€è¯·äººID
    invitee_id BIGINT NOT NULL,                          -- è¢«é‚€è¯·äººID
    invitation_token VARCHAR(128) NOT NULL UNIQUE,       -- é‚€è¯·token
    status ENUM('pending', 'accepted', 'rejected', 'expired') DEFAULT 'pending',
    message TEXT NULL,                                   -- é‚€è¯·æ¶ˆæ¯
    invited_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    responded_at TIMESTAMP NULL,

    UNIQUE KEY uk_group_invitee (group_id, invitee_id),
    INDEX idx_invitee_id (invitee_id),
    INDEX idx_invitation_token (invitation_token),
    INDEX idx_status (status),
    FOREIGN KEY (group_id) REFERENCES chat_groups(id) ON DELETE CASCADE,
    FOREIGN KEY (inviter_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (invitee_id) REFERENCES users(id) ON DELETE CASCADE
);
```

### æ•°æ®åº“ç´¢å¼•ç­–ç•¥
- **ç¾¤ç»„æŸ¥è¯¢ä¼˜åŒ–**: `group_type + is_active + created_at`
- **æ¶ˆæ¯æŸ¥è¯¢ä¼˜åŒ–**: `group_id + created_at DESC`
- **ç”¨æˆ·çŠ¶æ€ä¼˜åŒ–**: `user_id + is_online + last_active_at`
- **æˆå‘˜å…³ç³»ä¼˜åŒ–**: `group_id + user_id + is_active`

## ğŸ”Œ APIæ¥å£è®¾è®¡

### WebSocketè¿æ¥æ¥å£

#### è¿æ¥ç«¯ç‚¹
```
GET /api/v1/ws/chat?token={jwt_token}
```

#### è¿æ¥å‚æ•°
```typescript
interface WSConnectionParams {
  token: string;        // JWTè®¤è¯token
  groupId?: number;     // å¯é€‰ï¼šç›´æ¥åŠ å…¥çš„ç¾¤ç»„ID
  deviceType: string;   // è®¾å¤‡ç±»å‹ï¼šweb/mobile
}
```

#### æ¶ˆæ¯æ ¼å¼å®šä¹‰
```typescript
// WebSocketæ¶ˆæ¯åŸºç¡€æ ¼å¼
interface WSMessage {
  type: MessageType;
  groupId?: number;
  timestamp: number;
  data: any;
}

type MessageType =
  | 'join'           // åŠ å…¥ç¾¤ç»„
  | 'leave'          // ç¦»å¼€ç¾¤ç»„
  | 'message'        // å‘é€æ¶ˆæ¯
  | 'typing'         // æ­£åœ¨è¾“å…¥
  | 'status'         // çŠ¶æ€æ›´æ–°
  | 'read_receipt'   // å·²è¯»å›æ‰§
  | 'error'          // é”™è¯¯æ¶ˆæ¯;

// åŠ å…¥ç¾¤ç»„æ¶ˆæ¯
interface JoinMessage extends WSMessage {
  type: 'join';
  groupId: number;
  data: {
    userNick?: string;
  };
}

// èŠå¤©æ¶ˆæ¯
interface ChatMessage extends WSMessage {
  type: 'message';
  groupId: number;
  data: {
    content: string;
    messageType: 'text' | 'image';
    replyToId?: number;
    tempId?: string;     // ä¸´æ—¶æ¶ˆæ¯IDï¼Œç”¨äºå®¢æˆ·ç«¯å»é‡
  };
}

// æ­£åœ¨è¾“å…¥æ¶ˆæ¯
interface TypingMessage extends WSMessage {
  type: 'typing';
  groupId: number;
  data: {
    isTyping: boolean;
  };
}

// çŠ¶æ€æ›´æ–°æ¶ˆæ¯
interface StatusMessage extends WSMessage {
  type: 'status';
  data: {
    userId: number;
    isOnline: boolean;
    lastActiveAt: number;
  };
}

// å·²è¯»å›æ‰§æ¶ˆæ¯
interface ReadReceiptMessage extends WSMessage {
  type: 'read_receipt';
  groupId: number;
  data: {
    messageId: number;
    userId: number;
  };
}
```

### REST APIæ¥å£

#### 1. ç¾¤ç»„ç®¡ç†æ¥å£

##### åˆ›å»ºç¾¤ç»„
```http
POST /api/v1/chat/groups
Content-Type: application/json

{
  "groupName": "GameLinkæ€»èŠå¤©ç¾¤",
  "groupType": "public",           // public | order
  "maxMembers": 1000,
  "description": "å¤§å®¶ä¸€èµ·æ¥èŠå¤©å§ï¼",
  "avatarUrl": "https://example.com/avatar.jpg"
}
```

##### è·å–ç”¨æˆ·ç¾¤ç»„åˆ—è¡¨
```http
GET /api/v1/chat/groups?page=1&size=20&groupType=public

Response:
{
  "code": 200,
  "data": {
    "groups": [
      {
        "id": 1,
        "groupName": "GameLinkæ€»èŠå¤©ç¾¤",
        "groupType": "public",
        "memberCount": 156,
        "unreadCount": 3,
        "lastMessage": {
          "content": "å¤§å®¶å¥½ï¼",
          "senderName": "å°æ˜",
          "createdAt": "2025-11-10T10:30:00Z"
        },
        "avatarUrl": "https://example.com/avatar.jpg",
        "isActive": true,
        "createdAt": "2025-11-01T08:00:00Z"
      }
    ],
    "pagination": {
      "page": 1,
      "size": 20,
      "total": 45
    }
  }
}
```

##### è·å–ç¾¤ç»„è¯¦æƒ…
```http
GET /api/v1/chat/groups/{groupId}

Response:
{
  "code": 200,
  "data": {
    "id": 1,
    "groupName": "è®¢å•#12345 æœåŠ¡ç¾¤",
    "groupType": "order",
    "relatedOrderId": 12345,
    "memberCount": 3,
    "maxMembers": 10,
    "description": "è®¢å•æœåŠ¡ä¸“ç”¨ç¾¤ç»„",
    "avatarUrl": "https://example.com/avatar.jpg",
    "isActive": true,
    "autoDestroy": true,
    "createdAt": "2025-11-10T09:00:00Z",
    "members": [
      {
        "userId": 1001,
        "username": "ç”¨æˆ·å°å¼ ",
        "avatarUrl": "https://example.com/user1.jpg",
        "role": "member",
        "joinedAt": "2025-11-10T09:00:00Z",
        "isOnline": true
      },
      {
        "userId": 2001,
        "username": "é™ªç©å¸ˆå°æ",
        "avatarUrl": "https://example.com/player1.jpg",
        "role": "member",
        "joinedAt": "2025-11-10T09:01:00Z",
        "isOnline": true
      },
      {
        "userId": 3001,
        "username": "å®¢æœå°ç‹",
        "avatarUrl": "https://example.com/cs1.jpg",
        "role": "admin",
        "joinedAt": "2025-11-10T09:02:00Z",
        "isOnline": false
      }
    ]
  }
}
```

##### åŠ å…¥ç¾¤ç»„
```http
POST /api/v1/chat/groups/{groupId}/join
Content-Type: application/json

{
  "invitationToken": "abc123def456",  // å¯é€‰ï¼šé‚€è¯·token
  "nickname": "æˆ‘æƒ³åŠ å…¥ç¾¤èŠ"
}
```

##### ç¦»å¼€ç¾¤ç»„
```http
POST /api/v1/chat/groups/{groupId}/leave
Content-Type: application/json

{
  "reason": "ä¸éœ€è¦äº†"
}
```

##### è·å–ç¾¤ç»„æˆå‘˜åˆ—è¡¨
```http
GET /api/v1/chat/groups/{groupId}/members?page=1&size=50

Response:
{
  "code": 200,
  "data": {
    "members": [
      {
        "userId": 1001,
        "username": "ç”¨æˆ·å°å¼ ",
        "avatarUrl": "https://example.com/user1.jpg",
        "role": "member",
        "nickname": "å°å¼ ",
        "joinedAt": "2025-11-10T09:00:00Z",
        "lastActiveAt": "2025-11-10T10:30:00Z",
        "isOnline": true,
        "isMuted": false
      }
    ],
    "pagination": {
      "page": 1,
      "size": 50,
      "total": 3
    }
  }
}
```

#### 2. æ¶ˆæ¯ç®¡ç†æ¥å£

##### è·å–ç¾¤ç»„èŠå¤©è®°å½•
```http
GET /api/v1/chat/groups/{groupId}/messages?page=1&size=50&before={messageId}&messageType=text

Response:
{
  "code": 200,
  "data": {
    "messages": [
      {
        "id": 12345,
        "content": "å¤§å®¶å¥½ï¼æˆ‘æ˜¯æ–°ç”¨æˆ·",
        "messageType": "text",
        "senderId": 1001,
        "senderName": "ç”¨æˆ·å°å¼ ",
        "senderAvatar": "https://example.com/user1.jpg",
        "replyToId": null,
        "replyToContent": null,
        "createdAt": "2025-11-10T10:30:00Z",
        "updatedAt": "2025-11-10T10:30:00Z",
        "isDeleted": false,
        "isOwn": false
      },
      {
        "id": 12346,
        "content": "æ¬¢è¿æ–°æœ‹å‹ï¼",
        "messageType": "text",
        "senderId": 2001,
        "senderName": "é™ªç©å¸ˆå°æ",
        "senderAvatar": "https://example.com/player1.jpg",
        "replyToId": 12345,
        "replyToContent": "å¤§å®¶å¥½ï¼æˆ‘æ˜¯æ–°ç”¨æˆ·",
        "createdAt": "2025-11-10T10:31:00Z",
        "updatedAt": "2025-11-10T10:31:00Z",
        "isDeleted": false,
        "isOwn": false
      }
    ],
    "pagination": {
      "page": 1,
      "size": 50,
      "hasMore": true,
      "nextCursor": "12346"
    }
  }
}
```

##### å‘é€æ¶ˆæ¯ï¼ˆå¤‡ç”¨HTTPæ¥å£ï¼‰
```http
POST /api/v1/chat/groups/{groupId}/messages
Content-Type: application/json

{
  "content": "ä½ å¥½ï¼",
  "messageType": "text",           // text | image
  "replyToId": 12345               // å¯é€‰ï¼šå›å¤çš„æ¶ˆæ¯ID
}
```

##### æ ‡è®°æ¶ˆæ¯å·²è¯»
```http
POST /api/v1/chat/messages/{messageId}/read

Response:
{
  "code": 200,
  "data": {
    "success": true,
    "unreadCount": 0
  }
}
```

##### æ’¤å›æ¶ˆæ¯
```http
DELETE /api/v1/chat/messages/{messageId}

Response:
{
  "code": 200,
  "data": {
    "success": true
  }
}
```

#### 3. å›¾ç‰‡ä¸Šä¼ æ¥å£

##### ä¸Šä¼ èŠå¤©å›¾ç‰‡
```http
POST /api/v1/chat/upload-image
Content-Type: multipart/form-data

FormData:
- file: [å›¾ç‰‡æ–‡ä»¶]
- groupId: 1
- compress: true

Response:
{
  "code": 200,
  "data": {
    "imageUrl": "https://cdn.example.com/chat/images/abc123.jpg",
    "thumbnailUrl": "https://cdn.example.com/chat/thumbnails/abc123.jpg",
    "fileSize": 1024000,
    "width": 1920,
    "height": 1080,
    "uploadTime": "2025-11-10T10:30:00Z"
  }
}
```

#### 4. è®¢å•ç¾¤ç»„è‡ªåŠ¨åŒ–æ¥å£

##### åˆ›å»ºè®¢å•ç¾¤ç»„ï¼ˆå†…éƒ¨æ¥å£ï¼‰
```http
POST /api/v1/internal/chat/order-groups
Authorization: Bearer {internal_service_token}
Content-Type: application/json

{
  "orderId": 12345,
  "userId": 1001,
  "playerId": 2001,
  "customerServiceId": 3001,
  "groupName": "è®¢å•#12345 æœåŠ¡ç¾¤"
}
```

##### é”€æ¯è®¢å•ç¾¤ç»„ï¼ˆå†…éƒ¨æ¥å£ï¼‰
```http
DELETE /api/v1/internal/chat/order-groups/{orderId}
Authorization: Bearer {internal_service_token}
```

##### è·å–è®¢å•ç¾¤ç»„ä¿¡æ¯ï¼ˆå†…éƒ¨æ¥å£ï¼‰
```http
GET /api/v1/internal/chat/order-groups/{orderId}
Authorization: Bearer {internal_service_token}

Response:
{
  "code": 200,
  "data": {
    "groupId": 567,
    "groupName": "è®¢å•#12345 æœåŠ¡ç¾¤",
    "isActive": true,
    "memberCount": 3,
    "createdAt": "2025-11-10T09:00:00Z"
  }
}
```

#### 5. ç³»ç»Ÿç®¡ç†æ¥å£

##### è·å–ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯
```http
GET /api/v1/internal/chat/stats
Authorization: Bearer {admin_token}

Response:
{
  "code": 200,
  "data": {
    "totalGroups": 1250,
    "totalMessages": 156789,
    "activeGroups": 890,
    "onlineUsers": 234,
    "dailyMessages": 5678,
    "topActiveGroups": [
      {
        "groupId": 1,
        "groupName": "GameLinkæ€»èŠå¤©ç¾¤",
        "messageCount": 1234,
        "activeUsers": 89
      }
    ]
  }
}
```

## ğŸ¨ å‰ç«¯ç»„ä»¶è®¾è®¡

### ç»„ä»¶æ¶æ„å›¾
```
ChatContainer (ä¸»å®¹å™¨)
â”œâ”€â”€ GroupList (ç¾¤ç»„åˆ—è¡¨)
â”‚   â”œâ”€â”€ GroupItem (ç¾¤ç»„é¡¹)
â”‚   â””â”€â”€ UnreadBadge (æœªè¯»å¾½ç« )
â”œâ”€â”€ ChatWindow (èŠå¤©çª—å£)
â”‚   â”œâ”€â”€ ChatHeader (èŠå¤©å¤´éƒ¨)
â”‚   â”œâ”€â”€ MessageList (æ¶ˆæ¯åˆ—è¡¨)
â”‚   â”‚   â”œâ”€â”€ MessageItem (æ¶ˆæ¯é¡¹)
â”‚   â”‚   â”œâ”€â”€ ImageMessage (å›¾ç‰‡æ¶ˆæ¯)
â”‚   â”‚   â””â”€â”€ SystemMessage (ç³»ç»Ÿæ¶ˆæ¯)
â”‚   â”œâ”€â”€ MessageInput (æ¶ˆæ¯è¾“å…¥æ¡†)
â”‚   â”‚   â”œâ”€â”€ TextInput (æ–‡å­—è¾“å…¥)
â”‚   â”‚   â”œâ”€â”€ ImageUpload (å›¾ç‰‡ä¸Šä¼ )
â”‚   â”‚   â””â”€â”€ SendButton (å‘é€æŒ‰é’®)
â”‚   â””â”€â”€ MemberList (æˆå‘˜åˆ—è¡¨)
â””â”€â”€ NotificationPanel (é€šçŸ¥é¢æ¿)
```

### æ ¸å¿ƒç»„ä»¶å®šä¹‰

#### 1. ChatContainer ä¸»å®¹å™¨ç»„ä»¶
```typescript
interface ChatContainerProps {
  currentUser: User;
  defaultGroup?: ChatGroup;
  theme?: 'light' | 'dark';
  className?: string;
}

interface ChatContainerState {
  activeGroup?: ChatGroup;
  groups: ChatGroup[];
  isConnected: boolean;
  unreadCount: number;
  showMemberList: boolean;
}

const ChatContainer: React.FC<ChatContainerProps> = ({
  currentUser,
  defaultGroup,
  theme = 'light'
}) => {
  // WebSocketè¿æ¥ç®¡ç†
  // ç¾¤ç»„åˆ‡æ¢é€»è¾‘
  // æ¶ˆæ¯æ¥æ”¶å¤„ç†
  // æœªè¯»æ¶ˆæ¯ç»Ÿè®¡
};
```

#### 2. GroupList ç¾¤ç»„åˆ—è¡¨ç»„ä»¶
```typescript
interface GroupListProps {
  groups: ChatGroup[];
  activeGroupId?: number;
  onGroupSelect: (groupId: number) => void;
  onJoinPublicGroup: () => void;
  onCreateGroup: () => void;
  className?: string;
}

const GroupList: React.FC<GroupListProps> = ({
  groups,
  activeGroupId,
  onGroupSelect,
  onJoinPublicGroup,
  onCreateGroup
}) => {
  return (
    <div className="group-list">
      <div className="group-list-header">
        <h3>èŠå¤©ç¾¤ç»„</h3>
        <div className="group-actions">
          <button onClick={onJoinPublicGroup}>åŠ å…¥å…¬å…±ç¾¤</button>
          <button onClick={onCreateGroup}>åˆ›å»ºç¾¤ç»„</button>
        </div>
      </div>

      <div className="group-items">
        {groups.map(group => (
          <GroupItem
            key={group.id}
            group={group}
            isActive={group.id === activeGroupId}
            onClick={() => onGroupSelect(group.id)}
          />
        ))}
      </div>
    </div>
  );
};
```

#### 3. ChatWindow èŠå¤©çª—å£ç»„ä»¶
```typescript
interface ChatWindowProps {
  group: ChatGroup;
  currentUser: User;
  onSendMessage: (content: string, type: 'text' | 'image') => void;
  onTyping: (isTyping: boolean) => void;
  className?: string;
}

const ChatWindow: React.FC<ChatWindowProps> = ({
  group,
  currentUser,
  onSendMessage,
  onTyping
}) => {
  return (
    <div className="chat-window">
      <ChatHeader
        group={group}
        onToggleMemberList={() => setShowMemberList(!showMemberList)}
      />

      <MessageList
        groupId={group.id}
        currentUser={currentUser}
        messages={messages}
        onReply={handleReply}
        onLoadMore={handleLoadMore}
      />

      <MessageInput
        onSendMessage={onSendMessage}
        onTyping={onTyping}
        placeholder="è¾“å…¥æ¶ˆæ¯..."
        disabled={!group.isActive}
      />
    </div>
  );
};
```

#### 4. MessageList æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶
```typescript
interface MessageListProps {
  groupId: number;
  currentUser: User;
  messages: ChatMessage[];
  onReply: (messageId: number) => void;
  onLoadMore: () => void;
  hasMore: boolean;
  loading: boolean;
}

const MessageList: React.FC<MessageListProps> = ({
  groupId,
  currentUser,
  messages,
  onReply,
  onLoadMore,
  hasMore,
  loading
}) => {
  return (
    <div className="message-list" ref={messagesContainerRef}>
      {hasMore && (
        <LoadMoreButton onClick={onLoadMore} loading={loading} />
      )}

      <div className="messages">
        {messages.map(message => (
          <MessageItem
            key={message.id}
            message={message}
            isOwn={message.senderId === currentUser.id}
            onReply={onReply}
            onDelete={handleDelete}
          />
        ))}
      </div>

      <div ref={scrollToBottomRef} />
    </div>
  );
};
```

#### 5. MessageItem æ¶ˆæ¯é¡¹ç»„ä»¶
```typescript
interface MessageItemProps {
  message: ChatMessage;
  isOwn: boolean;
  onReply: (messageId: number) => void;
  onDelete: (messageId: number) => void;
  className?: string;
}

const MessageItem: React.FC<MessageItemProps> = ({
  message,
  isOwn,
  onReply,
  onDelete
}) => {
  return (
    <div className={`message-item ${isOwn ? 'own' : 'other'}`}>
      <div className="message-avatar">
        <img src={message.senderAvatar} alt={message.senderName} />
      </div>

      <div className="message-content">
        {!isOwn && (
          <div className="message-sender">{message.senderName}</div>
        )}

        <div className="message-bubble">
          {message.replyToId && (
            <ReplyPreview
              content={message.replyToContent}
              senderName={message.replyToSenderName}
            />
          )}

          {message.messageType === 'text' ? (
            <div className="text-content">{message.content}</div>
          ) : (
            <ImageMessage
              imageUrl={message.imageUrl}
              thumbnailUrl={message.thumbnailUrl}
              alt={message.content}
              onClick={handleImagePreview}
            />
          )}

          <div className="message-meta">
            <span className="message-time">
              {formatTime(message.createdAt)}
            </span>
            {isOwn && (
              <span className="message-status">
                {message.readStatus === 'read' ? 'å·²è¯»' : 'æœªè¯»'}
              </span>
            )}
          </div>
        </div>
      </div>

      <div className="message-actions">
        <button onClick={() => onReply(message.id)}>å›å¤</button>
        {isOwn && (
          <button onClick={() => onDelete(message.id)}>åˆ é™¤</button>
        )}
      </div>
    </div>
  );
};
```

#### 6. MessageInput æ¶ˆæ¯è¾“å…¥ç»„ä»¶
```typescript
interface MessageInputProps {
  onSendMessage: (content: string, type: 'text' | 'image') => void;
  onTyping: (isTyping: boolean) => void;
  placeholder?: string;
  disabled?: boolean;
  maxLength?: number;
}

const MessageInput: React.FC<MessageInputProps> = ({
  onSendMessage,
  onTyping,
  placeholder = 'è¾“å…¥æ¶ˆæ¯...',
  disabled = false,
  maxLength = 1000
}) => {
  const [message, setMessage] = useState('');
  const [isComposing, setIsComposing] = useState(false);

  const handleSend = () => {
    if (message.trim() && !disabled) {
      onSendMessage(message.trim(), 'text');
      setMessage('');
    }
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey && !isComposing) {
      e.preventDefault();
      handleSend();
    }
  };

  return (
    <div className="message-input">
      <div className="input-toolbar">
        <ImageUpload
          onImageSelect={(file) => {
            onSendMessage(file, 'image');
          }}
          maxSize={5 * 1024 * 1024} // 5MB
          acceptedFormats={['jpg', 'jpeg', 'png', 'gif', 'webp']}
        />
      </div>

      <div className="input-container">
        <textarea
          value={message}
          onChange={(e) => {
            setMessage(e.target.value);
            onTyping(true);
          }}
          onKeyPress={handleKeyPress}
          onCompositionStart={() => setIsComposing(true)}
          onCompositionEnd={() => setIsComposing(false)}
          placeholder={placeholder}
          disabled={disabled}
          maxLength={maxLength}
          rows={1}
        />

        <button
          onClick={handleSend}
          disabled={!message.trim() || disabled}
          className="send-button"
        >
          å‘é€
        </button>
      </div>
    </div>
  );
};
```

#### 7. ImageUpload å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
```typescript
interface ImageUploadProps {
  onImageSelect: (file: File) => void;
  maxSize?: number;
  acceptedFormats?: string[];
  className?: string;
}

const ImageUpload: React.FC<ImageUploadProps> = ({
  onImageSelect,
  maxSize = 5 * 1024 * 1024,
  acceptedFormats = ['jpg', 'jpeg', 'png', 'gif', 'webp']
}) => {
  const [uploading, setUploading] = useState(false);
  const [dragActive, setDragActive] = useState(false);

  const handleFileSelect = async (file: File) => {
    // æ–‡ä»¶å¤§å°æ£€æŸ¥
    if (file.size > maxSize) {
      toast.error('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MB');
      return;
    }

    // æ–‡ä»¶æ ¼å¼æ£€æŸ¥
    const fileExtension = file.name.split('.').pop()?.toLowerCase();
    if (!fileExtension || !acceptedFormats.includes(fileExtension)) {
      toast.error('ä¸æ”¯æŒçš„å›¾ç‰‡æ ¼å¼');
      return;
    }

    try {
      setUploading(true);
      await onImageSelect(file);
    } catch (error) {
      toast.error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥');
    } finally {
      setUploading(false);
    }
  };

  return (
    <div className="image-upload">
      <input
        type="file"
        accept="image/*"
        onChange={(e) => {
          const file = e.target.files?.[0];
          if (file) handleFileSelect(file);
        }}
        style={{ display: 'none' }}
        ref={fileInputRef}
      />

      <button
        onClick={() => fileInputRef.current?.click()}
        className="upload-button"
        disabled={uploading}
      >
        {uploading ? 'ä¸Šä¼ ä¸­...' : 'ğŸ“· å›¾ç‰‡'}
      </button>
    </div>
  );
};
```

### é¡µé¢é›†æˆè®¾è®¡

#### 1. æ¡Œé¢ç«¯é›†æˆ
```typescript
// ä¸»å¸ƒå±€é›†æˆ
const MainLayout: React.FC = () => {
  const [chatVisible, setChatVisible] = useState(false);
  const [unreadCount, setUnreadCount] = useState(0);

  return (
    <Layout className="main-layout">
      <Header className="main-header">
        <Navigation />
        <div className="header-actions">
          <NotificationButton />
          <ChatButton
            onClick={() => setChatVisible(true)}
            unreadCount={unreadCount}
          />
          <UserDropdown />
        </div>
      </Header>

      <Content className="main-content">
        <Routes>
          {/* å…¶ä»–é¡µé¢è·¯ç”± */}
        </Routes>
      </Content>

      {/* èŠå¤©æŠ½å±‰ */}
      <Drawer
        title="èŠå¤©"
        placement="right"
        width={400}
        open={chatVisible}
        onClose={() => setChatVisible(false)}
        className="chat-drawer"
      >
        <ChatContainer
          currentUser={currentUser}
          onUnreadCountChange={setUnreadCount}
        />
      </Drawer>
    </Layout>
  );
};

// èŠå¤©æŒ‰é’®ç»„ä»¶
const ChatButton: React.FC<{
  onClick: () => void;
  unreadCount: number;
}> = ({ onClick, unreadCount }) => (
  <Button
    type="text"
    icon={<MessageOutlined />}
    onClick={onClick}
    className="chat-button"
  >
    èŠå¤©
    {unreadCount > 0 && (
      <Badge count={unreadCount} size="small" />
    )}
  </Button>
);
```

#### 2. ç§»åŠ¨ç«¯é›†æˆ
```typescript
// ç§»åŠ¨ç«¯ç‹¬ç«‹èŠå¤©é¡µé¢
const MobileChatPage: React.FC = () => {
  return (
    <div className="mobile-chat-page">
      <MobileHeader
        title="èŠå¤©"
        onBack={() => navigate(-1)}
      />

      <div className="mobile-chat-container">
        <ChatContainer currentUser={currentUser} />
      </div>
    </div>
  );
};

// ç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆªé›†æˆ
const MobileNavigation: React.FC = () => {
  return (
    <TabBar className="mobile-navigation">
      <TabBar.Item
        title="é¦–é¡µ"
        key="home"
        icon={<HomeOutlined />}
        onClick={() => navigate('/home')}
      />

      <TabBar.Item
        title="èŠå¤©"
        key="chat"
        icon={<MessageOutlined />}
        onClick={() => navigate('/chat')}
        badge={unreadCount > 0 ? unreadCount : undefined}
      />

      <TabBar.Item
        title="è®¢å•"
        key="orders"
        icon={<ShoppingCartOutlined />}
        onClick={() => navigate('/orders')}
      />

      <TabBar.Item
        title="æˆ‘çš„"
        key="profile"
        icon={<UserOutlined />}
        onClick={() => navigate('/profile')}
      />
    </TabBar>
  );
};
```

### æ ·å¼è®¾è®¡è§„èŒƒ

#### 1. è‰²å½©æ–¹æ¡ˆ
```scss
// ä¸»è‰²è°ƒ
$primary-color: #1890ff;
$success-color: #52c41a;
$warning-color: #faad14;
$error-color: #ff4d4f;

// èŠå¤©ç•Œé¢è‰²å½©
$chat-bg: #f0f2f5;
$message-bubble-self: #1890ff;
$message-bubble-other: #ffffff;
$text-primary: #262626;
$text-secondary: #8c8c8c;
$border-color: #d9d9d9;
```

#### 2. å“åº”å¼è®¾è®¡
```scss
// æ¡Œé¢ç«¯
.chat-container {
  display: flex;
  height: 600px;
  border: 1px solid $border-color;
  border-radius: 8px;
  overflow: hidden;

  .group-list {
    width: 280px;
    border-right: 1px solid $border-color;
  }

  .chat-window {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
}

// å¹³æ¿ç«¯
@media (max-width: 768px) {
  .chat-container {
    height: 100vh;

    .group-list {
      width: 240px;
    }
  }
}

// ç§»åŠ¨ç«¯
@media (max-width: 480px) {
  .chat-container {
    .group-list {
      position: absolute;
      width: 100%;
      height: 100%;
      transform: translateX(-100%);
      transition: transform 0.3s ease;

      &.show {
        transform: translateX(0);
      }
    }
  }
}
```

## â±ï¸ å®æ–½è®¡åˆ’å’Œæ—¶é—´å®‰æ’

### é¡¹ç›®é‡Œç¨‹ç¢‘
- **é‡Œç¨‹ç¢‘1**: åŸºç¡€æ¶æ„å®Œæˆï¼ˆç¬¬1-2å‘¨ï¼‰
- **é‡Œç¨‹ç¢‘2**: æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼ˆç¬¬3å‘¨ï¼‰
- **é‡Œç¨‹ç¢‘3**: å‰ç«¯ç•Œé¢å®Œæˆï¼ˆç¬¬4å‘¨ï¼‰
- **é‡Œç¨‹ç¢‘4**: æµ‹è¯•ä¸Šçº¿å®Œæˆï¼ˆç¬¬5å‘¨ï¼‰

### è¯¦ç»†æ—¶é—´å®‰æ’

#### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¶æ„ï¼ˆ7å¤©ï¼‰

**Day 1-2ï¼šæ•°æ®åº“å’Œæ¨¡å‹å±‚**
- [ ] åˆ›å»ºèŠå¤©ç›¸å…³æ•°æ®è¡¨ç»“æ„
- [ ] è®¾è®¡GORMæ¨¡å‹å’Œå…³è”å…³ç³»
- [ ] ç¼–å†™æ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] åˆ›å»ºåŸºç¡€çš„Repositoryå±‚
- [ ] æ·»åŠ æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–

**Day 3-4ï¼šWebSocketæœåŠ¡ç«¯**
- [ ] é›†æˆgorilla/websocketåº“
- [ ] å®ç°è¿æ¥ç®¡ç†å™¨ï¼ˆConnectionManagerï¼‰
- [ ] å®ç°å¿ƒè·³æœºåˆ¶å’Œè¿æ¥ä¿æ´»
- [ ] è®¾è®¡æ¶ˆæ¯è·¯ç”±å’Œå¹¿æ’­é€»è¾‘
- [ ] å®ç°ç”¨æˆ·åœ¨çº¿çŠ¶æ€ç®¡ç†
- [ ] æ·»åŠ è¿æ¥è®¤è¯å’Œæƒé™éªŒè¯

**Day 5-6ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘**
- [ ] å®ç°ç¾¤ç»„ç®¡ç†Serviceï¼ˆGroupServiceï¼‰
- [ ] å®ç°æ¶ˆæ¯Serviceï¼ˆMessageServiceï¼‰
- [ ] å®ç°ç¾¤ç»„æˆå‘˜ç®¡ç†Serviceï¼ˆGroupMemberServiceï¼‰
- [ ] æ·»åŠ æ¶ˆæ¯æƒé™æ§åˆ¶å’Œå†…å®¹è¿‡æ»¤
- [ ] å®ç°æ¶ˆæ¯å»é‡å’Œæ—¶åºä¿è¯
- [ ] æ·»åŠ æ¶ˆæ¯å­˜å‚¨å’ŒæŸ¥è¯¢ä¼˜åŒ–

**Day 7ï¼šåŸºç¡€æµ‹è¯•**
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ï¼ˆç›®æ ‡80%+ï¼‰
- [ ] WebSocketè¿æ¥æµ‹è¯•
- [ ] åŸºç¡€åŠŸèƒ½é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½å‹æµ‹åˆæ­¥éªŒè¯

#### ç¬¬äºŒé˜¶æ®µï¼šAPIå’Œè‡ªåŠ¨åŒ–ï¼ˆ4å¤©ï¼‰

**Day 8-9ï¼šREST APIå¼€å‘**
- [ ] ç¾¤ç»„ç®¡ç†APIæ¥å£å®ç°
- [ ] æ¶ˆæ¯å†å²æŸ¥è¯¢APIå®ç°
- [ ] å›¾ç‰‡ä¸Šä¼ æ¥å£å®ç°
- [ ] APIå‚æ•°éªŒè¯å’Œé”™è¯¯å¤„ç†
- [ ] Swaggeræ–‡æ¡£ç”Ÿæˆ
- [ ] APIå®‰å…¨æ€§å’Œé¢‘ç‡é™åˆ¶

**Day 10ï¼šè®¢å•ç¾¤ç»„è‡ªåŠ¨åŒ–**
- [ ] ç›‘å¬è®¢å•çŠ¶æ€å˜åŒ–ï¼ˆOrderServiceé›†æˆï¼‰
- [ ] è‡ªåŠ¨åˆ›å»ºè®¢å•ç¾¤ç»„é€»è¾‘
- [ ] è‡ªåŠ¨æ·»åŠ ç›¸å…³æˆå‘˜ï¼ˆç”¨æˆ·ã€é™ªç©å¸ˆã€å®¢æœï¼‰
- [ ] è®¢å•ç»“æŸåè‡ªåŠ¨é”€æ¯ç¾¤ç»„
- [ ] å¼‚å¸¸æƒ…å†µå¤„ç†å’Œå›æ»šæœºåˆ¶

**Day 11ï¼šå…¬å…±èŠå¤©ç¾¤**
- [ ] åˆ›å»ºç³»ç»Ÿå…¬å…±èŠå¤©ç¾¤
- [ ] å®ç°ç”¨æˆ·è‡ªç”±åŠ å…¥/ç¦»å¼€åŠŸèƒ½
- [ ] æ·»åŠ ç¾¤ç»„ç®¡ç†åŠŸèƒ½ï¼ˆç¦è¨€ã€è¸¢äººã€è®¾ç®¡ç†å‘˜ï¼‰
- [ ] å®ç°ç¾¤ç»„é‚€è¯·æœºåˆ¶
- [ ] æ·»åŠ ç¾¤ç»„ç»Ÿè®¡å’Œæ´»è·ƒåº¦ç›‘æ§

#### ç¬¬ä¸‰é˜¶æ®µï¼šå‰ç«¯ç•Œé¢ï¼ˆ5å¤©ï¼‰

**Day 12-13ï¼šæ ¸å¿ƒèŠå¤©ç»„ä»¶**
- [ ] WebSocketå®¢æˆ·ç«¯å°è£…ï¼ˆuseWebSocket Hookï¼‰
- [ ] èŠå¤©çª—å£ç»„ä»¶å¼€å‘ï¼ˆChatWindowï¼‰
- [ ] æ¶ˆæ¯å±•ç¤ºç»„ä»¶ï¼ˆMessageItemã€MessageListï¼‰
- [ ] å®æ—¶æ¶ˆæ¯æ¥æ”¶å’ŒçŠ¶æ€åŒæ­¥
- [ ] æ¶ˆæ¯å‘é€å’Œé‡è¯•æœºåˆ¶

**Day 14-15ï¼šç”¨æˆ·ç•Œé¢å®Œå–„**
- [ ] ç¾¤ç»„åˆ—è¡¨ç»„ä»¶ï¼ˆGroupListï¼‰
- [ ] å›¾ç‰‡ä¸Šä¼ å’Œå±•ç¤ºç»„ä»¶
- [ ] æ¶ˆæ¯å·²è¯»çŠ¶æ€å®ç°
- [ ] ç§»åŠ¨ç«¯é€‚é…å’Œå“åº”å¼è®¾è®¡
- [ ] èŠå¤©ç•Œé¢äº¤äº’ä¼˜åŒ–

**Day 16ï¼šé›†æˆå’Œä¼˜åŒ–**
- [ ] ä¸ç°æœ‰ç³»ç»Ÿé›†æˆæµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆæ¶ˆæ¯åˆ†é¡µã€å›¾ç‰‡æ‡’åŠ è½½ï¼‰
- [ ] é”™è¯¯å¤„ç†å’Œç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
- [ ] ç•Œé¢ç»†èŠ‚è°ƒæ•´å’Œç¾åŒ–

#### ç¬¬å››é˜¶æ®µï¼šæµ‹è¯•å’Œä¸Šçº¿ï¼ˆ3å¤©ï¼‰

**Day 17-18ï¼šå…¨é¢æµ‹è¯•**
- [ ] åŠŸèƒ½æµ‹è¯•ï¼ˆæ‰€æœ‰åŠŸèƒ½ç‚¹éªŒè¯ï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆå¹¶å‘è¿æ¥ã€æ¶ˆæ¯ååé‡ï¼‰
- [ ] å®‰å…¨æµ‹è¯•ï¼ˆXSSã€CSRFã€æƒé™ç»•è¿‡ï¼‰
- [ ] ç”¨æˆ·ä½“éªŒæµ‹è¯•ï¼ˆUI/UXæµç¨‹éªŒè¯ï¼‰
- [ ] å‹åŠ›æµ‹è¯•å’Œç¨³å®šæ€§æµ‹è¯•
- [ ] å…¼å®¹æ€§æµ‹è¯•ï¼ˆæµè§ˆå™¨ã€è®¾å¤‡ï¼‰

**Day 19ï¼šéƒ¨ç½²ä¸Šçº¿**
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å’Œé…ç½®
- [ ] ç›‘æ§ç³»ç»Ÿé…ç½®ï¼ˆæ—¥å¿—ã€å‘Šè­¦ï¼‰
- [ ] ç”¨æˆ·æ–‡æ¡£å’Œæ“ä½œæ‰‹å†Œç¼–å†™
- [ ] ä¸Šçº¿å‘å¸ƒå’Œç°åº¦éªŒè¯
- [ ] ç”¨æˆ·åŸ¹è®­å’Œåé¦ˆæ”¶é›†

### é£é™©æ§åˆ¶å’Œåº”æ€¥é¢„æ¡ˆ

#### æŠ€æœ¯é£é™©
- **WebSocketè¿æ¥ç¨³å®šæ€§**: å®ç°æ–­çº¿é‡è¿å’Œæ¶ˆæ¯è¡¥å¿æœºåˆ¶
- **é«˜å¹¶å‘æ€§èƒ½**: ä½¿ç”¨Redis Pub/Subå’Œè¿æ¥æ± ä¼˜åŒ–
- **å›¾ç‰‡å­˜å‚¨**: è€ƒè™‘CDNåˆ†å‘å’Œå­˜å‚¨å®¹é‡è§„åˆ’
- **æ•°æ®åº“æ€§èƒ½**: æ¶ˆæ¯åˆ†è¡¨å’Œç´¢å¼•ä¼˜åŒ–ç­–ç•¥

#### è¿›åº¦é£é™©
- **éœ€æ±‚å˜æ›´**: é”å®šæ ¸å¿ƒéœ€æ±‚ï¼Œæ¬¡è¦åŠŸèƒ½å¯åç»­è¿­ä»£
- **æŠ€æœ¯éš¾ç‚¹**: é¢„ç•™2å¤©ç¼“å†²æ—¶é—´å¤„ç†æŠ€æœ¯éš¾é¢˜
- **äººå‘˜é…ç½®**: ç¡®ä¿å‰åç«¯å¼€å‘äººå‘˜åè°ƒé…åˆ
- **æµ‹è¯•æ—¶é—´**: ä¿è¯å……åˆ†æµ‹è¯•ï¼Œé¿å…ä¸Šçº¿åé—®é¢˜

## ğŸš€ æŠ€æœ¯å®ç°è¦ç‚¹

### WebSocketè¿æ¥ç®¡ç†
```go
// è¿æ¥ç®¡ç†å™¨
type ConnectionManager struct {
    connections map[string]*WebSocketConn
    userGroups  map[uint64]map[uint64]string // userID -> groupID -> connectionID
    mutex       sync.RWMutex
}

// è¿æ¥ç»“æ„
type WebSocketConn struct {
    conn    *websocket.Conn
    userID  uint64
    groupID uint64
    send    chan []byte
    ticker  *time.Ticker
}

// æ¶ˆæ¯å¹¿æ’­
func (cm *ConnectionManager) BroadcastToGroup(groupID uint64, message []byte) {
    cm.mutex.RLock()
    defer cm.mutex.RUnlock()

    for userID, conns := range cm.userGroups {
        if connID, exists := conns[groupID]; exists {
            if conn, ok := cm.connections[connID]; ok {
                select {
                case conn.send <- message:
                default:
                    close(conn.send)
                    delete(cm.connections, connID)
                }
            }
        }
    }
}
```

### æ¶ˆæ¯å¤„ç†æµç¨‹
```go
// æ¶ˆæ¯å¤„ç†å™¨
type MessageHandler struct {
    groupService   *GroupService
    messageService *MessageService
    connManager    *ConnectionManager
}

func (mh *MessageHandler) HandleMessage(wsConn *WebSocketConn, wsMsg *WSMessage) {
    switch wsMsg.Type {
    case "join":
        mh.handleJoinGroup(wsConn, wsMsg)
    case "leave":
        mh.handleLeaveGroup(wsConn, wsMsg)
    case "message":
        mh.handleChatMessage(wsConn, wsMsg)
    case "typing":
        mh.handleTyping(wsConn, wsMsg)
    case "read_receipt":
        mh.handleReadReceipt(wsConn, wsMsg)
    }
}

func (mh *MessageHandler) handleChatMessage(wsConn *WebSocketConn, wsMsg *WSMessage) {
    // 1. éªŒè¯ç”¨æˆ·æƒé™
    if !mh.groupService.IsUserInGroup(wsConn.userID, wsConn.groupID) {
        mh.sendError(wsConn, "æ— æƒé™å‘é€æ¶ˆæ¯")
        return
    }

    // 2. ä¿å­˜æ¶ˆæ¯åˆ°æ•°æ®åº“
    message, err := mh.messageService.CreateMessage(&CreateMessageRequest{
        GroupID:      wsConn.groupID,
        SenderID:     wsConn.userID,
        Content:      wsMsg.Data.Content,
        MessageType:  wsMsg.Data.MessageType,
        ReplyToID:    wsMsg.Data.ReplyToID,
    })

    if err != nil {
        mh.sendError(wsConn, "æ¶ˆæ¯å‘é€å¤±è´¥")
        return
    }

    // 3. å¹¿æ’­æ¶ˆæ¯ç»™ç¾¤ç»„æˆå‘˜
    broadcastMsg := &WSMessage{
        Type:      "message",
        GroupID:   wsConn.groupID,
        Timestamp: time.Now().Unix(),
        Data: map[string]interface{}{
            "id":           message.ID,
            "content":      message.Content,
            "messageType":  message.MessageType,
            "senderId":     message.SenderID,
            "senderName":   message.SenderName,
            "senderAvatar": message.SenderAvatar,
            "replyToId":    message.ReplyToID,
            "createdAt":    message.CreatedAt,
        },
    }

    mh.connManager.BroadcastToGroup(wsConn.groupID, broadcastMsg)

    // 4. å‘é€æ¨é€é€šçŸ¥ç»™ç¦»çº¿ç”¨æˆ·
    mh.sendPushNotification(wsConn.groupID, message)
}
```

### è®¢å•ç¾¤ç»„è‡ªåŠ¨åŒ–
```go
// è®¢å•ç›‘å¬å™¨
type OrderListener struct {
    groupService    *GroupService
    memberService   *GroupMemberService
    messageService  *MessageService
}

// ç›‘å¬è®¢å•çŠ¶æ€å˜åŒ–
func (ol *OrderListener) OnOrderStatusChanged(order *model.Order, oldStatus, newStatus model.OrderStatus) {
    switch newStatus {
    case model.OrderStatusConfirmed:
        ol.createOrderGroup(order)
    case model.OrderStatusCompleted, model.OrderStatusCanceled:
        ol.destroyOrderGroup(order.ID)
    }
}

func (ol *OrderListener) createOrderGroup(order *model.Order) {
    // 1. åˆ›å»ºè®¢å•ç¾¤ç»„
    group := &model.ChatGroup{
        GroupName:       fmt.Sprintf("è®¢å•#%d æœåŠ¡ç¾¤", order.ID),
        GroupType:       "order",
        RelatedOrderID:  &order.ID,
        CreatedBy:       0, // ç³»ç»Ÿåˆ›å»º
        MaxMembers:      10,
        AutoDestroy:     true,
    }

    createdGroup, err := ol.groupService.CreateGroup(group)
    if err != nil {
        log.Printf("åˆ›å»ºè®¢å•ç¾¤ç»„å¤±è´¥: %v", err)
        return
    }

    // 2. æ·»åŠ ç¾¤ç»„æˆå‘˜
    members := []*model.ChatGroupMember{
        {GroupID: createdGroup.ID, UserID: order.UserID, Role: "member"},
        {GroupID: createdGroup.ID, UserID: order.GetPlayerID(), Role: "member"},
        {GroupID: createdGroup.ID, UserID: ol.getCustomerServiceID(), Role: "admin"},
    }

    for _, member := range members {
        ol.memberService.AddMember(member)
    }

    // 3. å‘é€æ¬¢è¿æ¶ˆæ¯
    ol.messageService.CreateMessage(&model.ChatMessage{
        GroupID:      createdGroup.ID,
        SenderID:     0, // ç³»ç»Ÿæ¶ˆæ¯
        Content:      fmt.Sprintf("è®¢å•æœåŠ¡ç¾¤ç»„å·²åˆ›å»ºï¼Œè®¢å•å·ï¼š%s", order.OrderNo),
        MessageType:  "system",
    })
}

func (ol *OrderListener) destroyOrderGroup(orderID uint64) {
    group, err := ol.groupService.GetGroupByOrderID(orderID)
    if err != nil {
        return
    }

    // å‘é€ç¾¤ç»„å³å°†é”€æ¯çš„é€šçŸ¥
    ol.messageService.CreateMessage(&model.ChatMessage{
        GroupID:      group.ID,
        SenderID:     0, // ç³»ç»Ÿæ¶ˆæ¯
        Content:      "è®¢å•å·²å®Œæˆï¼Œæœ¬ç¾¤ç»„å°†åœ¨30åˆ†é’Ÿåè‡ªåŠ¨é”€æ¯",
        MessageType:  "system",
    })

    // å»¶è¿Ÿé”€æ¯ç¾¤ç»„
    time.AfterFunc(30*time.Minute, func() {
        ol.groupService.DestroyGroup(group.ID)
    })
}
```

### å›¾ç‰‡å¤„ç†ç­–ç•¥
```go
// å›¾ç‰‡ä¸Šä¼ å¤„ç†å™¨
type ImageUploadHandler struct {
    storageService StorageService
    imageProcessor ImageProcessor
}

func (iuh *ImageUploadHandler) HandleUpload(c *gin.Context) {
    // 1. è§£æè¡¨å•æ•°æ®
    file, header, err := c.Request.FormFile("file")
    if err != nil {
        c.JSON(400, gin.H{"error": "æ–‡ä»¶ä¸Šä¼ å¤±è´¥"})
        return
    }
    defer file.Close()

    // 2. æ–‡ä»¶éªŒè¯
    if !iuh.validateImageFile(header) {
        c.JSON(400, gin.H{"error": "ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼æˆ–å¤§å°è¶…é™"})
        return
    }

    // 3. å›¾ç‰‡å¤„ç†
    processedImage, err := iuh.imageProcessor.Process(file, ImageProcessOptions{
        MaxWidth:     1920,
        MaxHeight:    1080,
        Quality:      80,
        GenerateThumb: true,
        ThumbWidth:   200,
        ThumbHeight:  200,
    })

    if err != nil {
        c.JSON(500, gin.H{"error": "å›¾ç‰‡å¤„ç†å¤±è´¥"})
        return
    }

    // 4. å­˜å‚¨æ–‡ä»¶
    imageID := generateImageID()
    imageURL, err := iuh.storageService.Store(imageID, processedImage.Image)
    if err != nil {
        c.JSON(500, gin.H{"error": "å›¾ç‰‡å­˜å‚¨å¤±è´¥"})
        return
    }

    thumbURL, err := iuh.storageService.Store(imageID+"_thumb", processedImage.Thumbnail)
    if err != nil {
        c.JSON(500, gin.H{"error": "ç¼©ç•¥å›¾å­˜å‚¨å¤±è´¥"})
        return
    }

    // 5. è¿”å›ç»“æœ
    c.JSON(200, gin.H{
        "imageUrl":     imageURL,
        "thumbnailUrl": thumbURL,
        "width":        processedImage.Width,
        "height":       processedImage.Height,
        "fileSize":     header.Size,
    })
}

func (iuh *ImageUploadHandler) validateImageFile(header *multipart.FileHeader) bool {
    // å¤§å°æ£€æŸ¥ï¼ˆ5MBï¼‰
    if header.Size > 5*1024*1024 {
        return false
    }

    // æ ¼å¼æ£€æŸ¥
    allowedFormats := []string{"jpg", "jpeg", "png", "gif", "webp"}
    ext := strings.ToLower(filepath.Ext(header.Filename))
    if len(ext) > 0 {
        ext = ext[1:] // å»æ‰ç‚¹å·
    }

    for _, format := range allowedFormats {
        if ext == format {
            return true
        }
    }

    return false
}
```

### å‰ç«¯WebSocketå°è£…
```typescript
// WebSocket Hook
export const useWebSocket = (url: string, options: WSOptions = {}) => {
  const [socket, setSocket] = useState<WebSocket | null>(null);
  const [isConnected, setIsConnected] = useState(false);
  const [lastMessage, setLastMessage] = useState<any>(null);
  const reconnectCountRef = useRef(0);
  const maxReconnectAttempts = 5;

  const connect = useCallback(() => {
    try {
      const ws = new WebSocket(url);

      ws.onopen = () => {
        setIsConnected(true);
        reconnectCountRef.current = 0;
        options.onOpen?.();
      };

      ws.onmessage = (event) => {
        try {
          const message = JSON.parse(event.data);
          setLastMessage(message);
          options.onMessage?.(message);
        } catch (error) {
          console.error('WebSocketæ¶ˆæ¯è§£æå¤±è´¥:', error);
        }
      };

      ws.onclose = (event) => {
        setIsConnected(false);
        setSocket(null);
        options.onClose?.(event);

        // è‡ªåŠ¨é‡è¿é€»è¾‘
        if (reconnectCountRef.current < maxReconnectAttempts) {
          reconnectCountRef.current++;
          const delay = Math.pow(2, reconnectCountRef.current) * 1000; // æŒ‡æ•°é€€é¿
          setTimeout(connect, delay);
        }
      };

      ws.onerror = (error) => {
        console.error('WebSocketè¿æ¥é”™è¯¯:', error);
        options.onError?.(error);
      };

      setSocket(ws);
    } catch (error) {
      console.error('WebSocketè¿æ¥å¤±è´¥:', error);
    }
  }, [url, options]);

  const sendMessage = useCallback((message: any) => {
    if (socket && socket.readyState === WebSocket.OPEN) {
      socket.send(JSON.stringify(message));
      return true;
    }
    return false;
  }, [socket]);

  const disconnect = useCallback(() => {
    if (socket) {
      socket.close();
    }
  }, [socket]);

  useEffect(() => {
    connect();
    return () => disconnect();
  }, [connect, disconnect]);

  return {
    socket,
    isConnected,
    lastMessage,
    sendMessage,
    disconnect,
  };
};

// ä½¿ç”¨ç¤ºä¾‹
const ChatContainer: React.FC = () => {
  const { user } = useAuth();
  const token = localStorage.getItem('token');
  const wsUrl = `ws://localhost:8080/api/v1/ws/chat?token=${token}`;

  const { isConnected, lastMessage, sendMessage } = useWebSocket(wsUrl, {
    onMessage: (message) => {
      switch (message.type) {
        case 'message':
          // å¤„ç†æ–°æ¶ˆæ¯
          dispatch(addMessage(message.data));
          break;
        case 'typing':
          // å¤„ç†æ­£åœ¨è¾“å…¥çŠ¶æ€
          dispatch(updateTypingStatus(message.data));
          break;
        case 'status':
          // å¤„ç†ç”¨æˆ·çŠ¶æ€æ›´æ–°
          dispatch(updateUserStatus(message.data));
          break;
      }
    },
    onOpen: () => {
      console.log('WebSocketè¿æ¥å·²å»ºç«‹');
    },
    onClose: () => {
      console.log('WebSocketè¿æ¥å·²æ–­å¼€');
    }
  });

  const handleSendMessage = useCallback((content: string, type: 'text' | 'image') => {
    sendMessage({
      type: 'message',
      groupId: activeGroupId,
      data: {
        content,
        messageType: type,
        tempId: generateTempId(),
      },
    });
  }, [sendMessage, activeGroupId]);

  return (
    <div className="chat-container">
      <div className="connection-status">
        {isConnected ? 'ğŸŸ¢ å·²è¿æ¥' : 'ğŸ”´ è¿æ¥ä¸­...'}
      </div>

      {/* èŠå¤©ç•Œé¢ç»„ä»¶ */}
      <ChatWindow onSendMessage={handleSendMessage} />
    </div>
  );
};
```

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§æ€»ç»“

### âœ… æ ¸å¿ƒåŠŸèƒ½åˆ—è¡¨

#### 1. ç¾¤ç»„ç®¡ç†
- **å…¬å…±èŠå¤©ç¾¤**: æ‰€æœ‰ç”¨æˆ·å¯è‡ªç”±åŠ å…¥çš„èŠå¤©å®¤
- **è®¢å•å°ç¾¤**: 3äººå°ç»„ï¼ˆç”¨æˆ·+é™ªç©å¸ˆ+å®¢æœï¼‰ï¼Œè®¢å•ç»“æŸåè‡ªåŠ¨é”€æ¯
- **ç¾¤ç»„åˆ›å»º**: æ”¯æŒç”¨æˆ·åˆ›å»ºè‡ªå®šä¹‰ç¾¤ç»„
- **æˆå‘˜ç®¡ç†**: æ·»åŠ /ç§»é™¤æˆå‘˜ï¼Œè§’è‰²æƒé™æ§åˆ¶
- **ç¾¤ç»„è®¾ç½®**: ç¾¤åç§°ã€æè¿°ã€å¤´åƒç­‰é…ç½®

#### 2. æ¶ˆæ¯åŠŸèƒ½
- **æ–‡å­—æ¶ˆæ¯**: å®æ—¶æ–‡å­—é€šä¿¡ï¼Œæ”¯æŒé•¿æ–‡æœ¬
- **å›¾ç‰‡æ¶ˆæ¯**: æ”¯æŒå›¾ç‰‡ä¸Šä¼ å’Œå±•ç¤ºï¼Œè‡ªåŠ¨å‹ç¼©ä¼˜åŒ–
- **æ¶ˆæ¯å›å¤**: æ”¯æŒå›å¤ç‰¹å®šæ¶ˆæ¯ï¼Œå½¢æˆå¯¹è¯é“¾
- **æ¶ˆæ¯æ’¤å›**: å‘é€åå¯æ’¤å›æ¶ˆæ¯ï¼ˆæ—¶é—´é™åˆ¶ï¼‰
- **æ¶ˆæ¯ç¼–è¾‘**: æ”¯æŒç¼–è¾‘å·²å‘é€çš„æ¶ˆæ¯
- **æ¶ˆæ¯åˆ é™¤**: åˆ é™¤æ¶ˆæ¯åŠŸèƒ½ï¼ˆç®¡ç†å‘˜ï¼‰

#### 3. å®æ—¶é€šä¿¡
- **WebSocketè¿æ¥**: ç¨³å®šçš„é•¿è¿æ¥é€šä¿¡
- **æ–­çº¿é‡è¿**: è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼Œä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±
- **åœ¨çº¿çŠ¶æ€**: å®æ—¶æ˜¾ç¤ºç”¨æˆ·åœ¨çº¿/ç¦»çº¿çŠ¶æ€
- **æ­£åœ¨è¾“å…¥**: æ˜¾ç¤ºç”¨æˆ·æ­£åœ¨è¾“å…¥çŠ¶æ€
- **æ¶ˆæ¯æ¨é€**: ç¦»çº¿æ¶ˆæ¯æ¨é€é€šçŸ¥

#### 4. æ¶ˆæ¯ç®¡ç†
- **æ¶ˆæ¯å†å²**: å®Œæ•´çš„èŠå¤©è®°å½•å­˜å‚¨å’ŒæŸ¥è¯¢
- **æ¶ˆæ¯åˆ†é¡µ**: é«˜æ•ˆçš„æ¶ˆæ¯åŠ è½½æœºåˆ¶
- **æ¶ˆæ¯æœç´¢**: èŠå¤©è®°å½•å…³é”®è¯æœç´¢
- **å·²è¯»çŠ¶æ€**: æ¶ˆæ¯å·²è¯»/æœªè¯»çŠ¶æ€è·Ÿè¸ª
- **æœªè¯»è®¡æ•°**: ç¾¤ç»„æœªè¯»æ¶ˆæ¯æ•°é‡æ˜¾ç¤º

#### 5. åª’ä½“å¤„ç†
- **å›¾ç‰‡ä¸Šä¼ **: æ‹–æ‹½ä¸Šä¼ ã€ç‚¹å‡»é€‰æ‹©å¤šç§æ–¹å¼
- **å›¾ç‰‡å‹ç¼©**: è‡ªåŠ¨å‹ç¼©ä¼˜åŒ–å­˜å‚¨ç©ºé—´
- **ç¼©ç•¥å›¾ç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾æå‡åŠ è½½é€Ÿåº¦
- **æ ¼å¼æ”¯æŒ**: æ”¯æŒä¸»æµå›¾ç‰‡æ ¼å¼ï¼ˆjpgã€pngã€gifã€webpï¼‰
- **å¤§å°é™åˆ¶**: 5MBä¸Šä¼ é™åˆ¶ï¼Œé˜²æ­¢æ»¥ç”¨

#### 6. ç”¨æˆ·ä½“éªŒ
- **å“åº”å¼è®¾è®¡**: æ¡Œé¢ç«¯ã€å¹³æ¿ç«¯ã€ç§»åŠ¨ç«¯å®Œç¾é€‚é…
- **å®æ—¶é€šçŸ¥**: æ–°æ¶ˆæ¯æ¡Œé¢é€šçŸ¥
- **å¿«æ·æ“ä½œ**: è¡¨æƒ…åŒ…ã€å¿«æ·å›å¤ã€å¿«æ·é”®æ”¯æŒ
- **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜
- **å¤šè¯­è¨€**: æ”¯æŒä¸­è‹±æ–‡ç•Œé¢åˆ‡æ¢

### ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨

#### 1. è®¢å•æœåŠ¡åœºæ™¯
```
ç”¨æˆ·ä¸‹å• â†’ è‡ªåŠ¨åˆ›å»ºè®¢å•ç¾¤ç»„ â†’ ä¸‰æ–¹æ²Ÿé€š â†’ æœåŠ¡å®Œæˆ â†’ è‡ªåŠ¨é”€æ¯ç¾¤ç»„
```
- **å‚ä¸è€…**: ç”¨æˆ·ã€é™ªç©å¸ˆã€å®¢æœ
- **ç”Ÿå‘½å‘¨æœŸ**: è·Ÿéšè®¢å•çŠ¶æ€
- **ä¸»è¦åŠŸèƒ½**: æœåŠ¡åè°ƒã€é—®é¢˜æ²Ÿé€šã€è¿›åº¦åé¦ˆ

#### 2. å…¬å…±ç¤¾äº¤åœºæ™¯
```
ç”¨æˆ·æ³¨å†Œ â†’ åŠ å…¥å…¬å…±ç¾¤ç»„ â†’ è‡ªç”±èŠå¤© â†’ å»ºç«‹å…³ç³» â†’ ç§ä¿¡æ²Ÿé€š
```
- **å‚ä¸è€…**: æ‰€æœ‰æ³¨å†Œç”¨æˆ·
- **ç”Ÿå‘½å‘¨æœŸ**: æ°¸ä¹…å­˜åœ¨
- **ä¸»è¦åŠŸèƒ½**: ç¤¾äº¤äº’åŠ¨ã€ç»éªŒåˆ†äº«ã€é—®é¢˜è®¨è®º

#### 3. å®¢æœæ”¯æŒåœºæ™¯
```
ç”¨æˆ·é‡åˆ°é—®é¢˜ â†’ è”ç³»å®¢æœ â†’ åˆ›å»ºä¸“å±ç¾¤ç»„ â†’ é—®é¢˜è§£å†³ â†’ ç¾¤ç»„å½’æ¡£
```
- **å‚ä¸è€…**: ç”¨æˆ·ã€å®¢æœã€ç›¸å…³æŠ€æœ¯äººå‘˜
- **ç”Ÿå‘½å‘¨æœŸ**: é—®é¢˜è§£å†³å‘¨æœŸ
- **ä¸»è¦åŠŸèƒ½**: æŠ€æœ¯æ”¯æŒã€æŠ•è¯‰å¤„ç†ã€æœåŠ¡åé¦ˆ

### ğŸ”’ å®‰å…¨å’Œæƒé™æ§åˆ¶

#### 1. èº«ä»½è®¤è¯
- **JWTéªŒè¯**: WebSocketè¿æ¥JWT tokenéªŒè¯
- **æƒé™æ£€æŸ¥**: æ¯ä¸ªæ“ä½œéƒ½è¿›è¡Œæƒé™éªŒè¯
- **ä¼šè¯ç®¡ç†**: ç”¨æˆ·ä¼šè¯çŠ¶æ€ç®¡ç†å’Œè¶…æ—¶æ§åˆ¶

#### 2. ç¾¤ç»„æƒé™
- **æˆå‘˜èº«ä»½**: éªŒè¯ç”¨æˆ·ç¾¤ç»„æˆå‘˜èº«ä»½
- **è§’è‰²æƒé™**: owner/admin/memberä¸åŒæƒé™çº§åˆ«
- **æ“ä½œé™åˆ¶**: éæˆå‘˜æ— æ³•æŸ¥çœ‹æˆ–å‘é€æ¶ˆæ¯

#### 3. å†…å®¹å®‰å…¨
- **æ¶ˆæ¯è¿‡æ»¤**: æ•æ„Ÿè¯è¿‡æ»¤å’Œå†…å®¹å®¡æ ¸
- **é¢‘ç‡é™åˆ¶**: å‘é€æ¶ˆæ¯é¢‘ç‡æ§åˆ¶ï¼Œé˜²æ­¢åˆ·å±
- **æ–‡ä»¶å®‰å…¨**: å›¾ç‰‡æ ¼å¼å’Œå¤§å°éªŒè¯

#### 4. éšç§ä¿æŠ¤
- **æ¶ˆæ¯åŠ å¯†**: æ¶ˆæ¯ä¼ è¾“åŠ å¯†å­˜å‚¨
- **æ•°æ®éš”ç¦»**: ä¸åŒç¾¤ç»„æ•°æ®å®Œå…¨éš”ç¦»
- **è®¿é—®æ§åˆ¶**: ä¸¥æ ¼çš„APIè®¿é—®æ§åˆ¶

### ğŸ“Š æ€§èƒ½å’Œæ‰©å±•æ€§

#### 1. è¿æ¥ç®¡ç†
- **è¿æ¥æ± **: WebSocketè¿æ¥æ± ç®¡ç†
- **è´Ÿè½½å‡è¡¡**: æ”¯æŒå¤šå®ä¾‹è´Ÿè½½å‡è¡¡
- **æ°´å¹³æ‰©å±•**: æ”¯æŒé›†ç¾¤éƒ¨ç½²å’Œæ‰©å±•

#### 2. æ¶ˆæ¯å¤„ç†
- **å¼‚æ­¥å¤„ç†**: æ¶ˆæ¯å‘é€å’Œå­˜å‚¨å¼‚æ­¥å¤„ç†
- **æ‰¹é‡æ“ä½œ**: æ‰¹é‡æ¶ˆæ¯æ’å…¥å’ŒæŸ¥è¯¢ä¼˜åŒ–
- **ç¼“å­˜ç­–ç•¥**: Redisç¼“å­˜çƒ­ç‚¹æ•°æ®

#### 3. å­˜å‚¨ä¼˜åŒ–
- **åˆ†è¡¨ç­–ç•¥**: æ¶ˆæ¯è¡¨æŒ‰æ—¶é—´åˆ†è¡¨å­˜å‚¨
- **ç´¢å¼•ä¼˜åŒ–**: é’ˆå¯¹æŸ¥è¯¢æ¨¡å¼çš„ç´¢å¼•è®¾è®¡
- **æ•°æ®å‹ç¼©**: å†å²æ•°æ®å‹ç¼©å­˜å‚¨

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIæ¥å£æ–‡æ¡£](./api/chat-api.md)
- [æ•°æ®åº“è®¾è®¡æ–‡æ¡£](./database/chat-schema.md)
- [å‰ç«¯ç»„ä»¶æ–‡æ¡£](./frontend/chat-components.md)
- [éƒ¨ç½²è¿ç»´æ–‡æ¡£](./deployment/chat-deployment.md)
- [æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£](./testing/chat-test-cases.md)

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»ï¼š
- **å¼€å‘å›¢é˜Ÿ**: dev-team@gamelink.com
- **äº§å“å›¢é˜Ÿ**: product-team@gamelink.com
- **æŠ€æœ¯æ”¯æŒ: support@gamelink.com

---

*æœ¬æ–‡æ¡£æœ€åæ›´æ–°æ—¶é—´: 2025-11-10*
*æ–‡æ¡£ç‰ˆæœ¬: v1.0*