# ğŸ¯ GameLink åç«¯æµ‹è¯•è¦†ç›–ç‡æ”¹è¿› - ä¸¤éƒ¨åˆ†è®¡åˆ’

**å½“å‰åç«¯è¦†ç›–ç‡**: 49.5%  
**ç›®æ ‡è¦†ç›–ç‡**: 65-70%  
**æ€»å·¥æœŸ**: 2å‘¨  
**åˆ†å·¥**: ä¸¤éƒ¨åˆ†ç‹¬ç«‹å·¥ä½œ

---

## ğŸ“Š åç«¯è¦†ç›–ç‡ç°çŠ¶åˆ†æ

### æ€»ä½“åˆ†å¸ƒ
```
é«˜è¦†ç›–ç‡ (â‰¥80%):  Repository å±‚ã€Statsã€Auth ç­‰ â†’ 8ä¸ªæ¨¡å—
ä¸­ç­‰è¦†ç›–ç‡ (50-79%): Service å±‚ã€éƒ¨åˆ† Repository â†’ 16ä¸ªæ¨¡å—
ä½è¦†ç›–ç‡ (<50%):  Handler å±‚ã€Metricsã€Logging â†’ 11ä¸ªæ¨¡å—
```

### å…³é”®æ•°æ®
| å±‚çº§ | å½“å‰è¦†ç›–ç‡ | ç›®æ ‡è¦†ç›–ç‡ | æ”¹è¿›ç©ºé—´ |
|------|-----------|-----------|---------|
| Handler å±‚ | 32-39% | 65-70% | +26-38% |
| Service å±‚ | 49-100% | 70-95% | +21-46% |
| Repository å±‚ | 66-100% | 80-100% | +14-34% |
| å…¶ä»–æ¨¡å— | 0-73% | 60-80% | +60-80% |

---

## ğŸ”´ ç¬¬ä¸€éƒ¨åˆ†: Handler å±‚å¿«é€Ÿè¦†ç›– (1å‘¨)

### ç›®æ ‡
- Handler å±‚è¦†ç›–ç‡: 32-39% â†’ **50%+**
- åç«¯æ•´ä½“è¦†ç›–ç‡: 49.5% â†’ **55-60%**
- å®Œæˆ 7 ä¸ªå…³é”®å¤„ç†å™¨æ–‡ä»¶çš„åŸºç¡€æµ‹è¯•

### å·¥ä½œåˆ†è§£

#### 1ï¸âƒ£ ç®¡ç†ç«¯å¤„ç†å™¨ - å¿«é€Ÿè¦†ç›– (2-3å¤©)

**ä¼˜å…ˆçº§æœ€é«˜** (0% â†’ 60%):

| æ–‡ä»¶ | å½“å‰ | ç›®æ ‡ | å·¥ä½œé‡ | å…³é”®æµ‹è¯• |
|------|------|------|--------|---------|
| `admin/commission.go` | 0% | 60% | 2h | Create, List, Update, Delete |
| `admin/item.go` | 0% | 60% | 2h | Create, List, Update, Delete |
| `admin/ranking.go` | 0% | 60% | 2h | Create, List, Update, Delete |
| `admin/withdraw.go` | 0% | 60% | 2h | Create, List, Approve, Reject |

**æµ‹è¯•æ¨¡æ¿**:
```go
package admin

import (
    "testing"
    "github.com/stretchr/testify/assert"
)

func TestCreateCommission(t *testing.T) {
    // 1. å‡†å¤‡ Mock Service
    mockService := &MockCommissionService{}
    handler := &CommissionHandler{Service: mockService}
    
    // 2. æµ‹è¯•æˆåŠŸåœºæ™¯
    t.Run("æˆåŠŸåˆ›å»ºä½£é‡‘", func(t *testing.T) {
        req := &CreateCommissionReq{
            Name: "test",
            Rate: 0.1,
        }
        resp, err := handler.CreateCommission(req)
        assert.NoError(t, err)
        assert.NotNil(t, resp)
    })
    
    // 3. æµ‹è¯•å¤±è´¥åœºæ™¯
    t.Run("å‚æ•°éªŒè¯å¤±è´¥", func(t *testing.T) {
        req := &CreateCommissionReq{
            Name: "",  // ç©ºå€¼
            Rate: -1,  // è´Ÿæ•°
        }
        resp, err := handler.CreateCommission(req)
        assert.Error(t, err)
        assert.Nil(t, resp)
    })
}
```

**éªŒè¯æ–¹å¼**:
```bash
go test -v -coverprofile=coverage_admin.out ./internal/handler/admin/...
go tool cover -func=coverage_admin.out | grep commission
# æœŸæœ›: commission.go è¦†ç›–ç‡ â‰¥60%
```

#### 2ï¸âƒ£ ç”¨æˆ·ç«¯å¤„ç†å™¨ - å¿«é€Ÿè¦†ç›– (2-3å¤©)

**ä¼˜å…ˆçº§é«˜** (0% â†’ 60%):

| æ–‡ä»¶ | å½“å‰ | ç›®æ ‡ | å·¥ä½œé‡ | å…³é”®æµ‹è¯• |
|------|------|------|--------|---------|
| `user/gift.go` | 0% | 60% | 2h | Send, List, Receive |
| `user/order.go` | 66.7% | 75% | 1.5h | Create, List, Cancel |
| `user/payment.go` | 80% | 85% | 1h | Process, Verify, Refund |

**å…³é”®æµ‹è¯•åœºæ™¯**:
```go
// æµ‹è¯• gift.go
- æˆåŠŸå‘é€ç¤¼ç‰©
- ç¤¼ç‰©æ¥æ”¶è€…ä¸å­˜åœ¨
- ç¤¼ç‰©æ•°é‡ä¸è¶³
- è·å–ç”¨æˆ·ç¤¼ç‰©åˆ—è¡¨
- æ¥æ”¶ç¤¼ç‰©

// æµ‹è¯• order.go
- åˆ›å»ºè®¢å•æˆåŠŸ
- è®¢å•å‚æ•°éªŒè¯
- è®¢å•åˆ—è¡¨åˆ†é¡µ
- å–æ¶ˆè®¢å•
- è®¢å•çŠ¶æ€æ›´æ–°

// æµ‹è¯• payment.go
- æ”¯ä»˜å¤„ç†æˆåŠŸ
- æ”¯ä»˜éªŒè¯å¤±è´¥
- é€€æ¬¾å¤„ç†
```

#### 3ï¸âƒ£ ç©å®¶ç«¯å¤„ç†å™¨ - å¿«é€Ÿè¦†ç›– (2-3å¤©)

**ä¼˜å…ˆçº§é«˜** (0% â†’ 60%):

| æ–‡ä»¶ | å½“å‰ | ç›®æ ‡ | å·¥ä½œé‡ | å…³é”®æµ‹è¯• |
|------|------|------|--------|---------|
| `player/commission.go` | 0% | 60% | 2h | Query, List, Withdraw |
| `player/earnings.go` | 66.7% | 75% | 1.5h | Get, List, Trend |
| `player/gift.go` | 0% | 60% | 2h | List, Accept, Reject |

**å…³é”®æµ‹è¯•åœºæ™¯**:
```go
// æµ‹è¯• commission.go
- æŸ¥è¯¢ä½£é‡‘è¯¦æƒ…
- è·å–ä½£é‡‘åˆ—è¡¨
- ä½£é‡‘æç°ç”³è¯·
- æç°å†å²æŸ¥è¯¢

// æµ‹è¯• earnings.go
- è·å–æ”¶ç›Šæ€»é¢
- æ”¶ç›Šåˆ—è¡¨åˆ†é¡µ
- æ”¶ç›Šè¶‹åŠ¿æ•°æ®
- æŒ‰æ—¶é—´æ®µç»Ÿè®¡

// æµ‹è¯• gift.go
- è·å–ç¤¼ç‰©åˆ—è¡¨
- æ¥å—ç¤¼ç‰©
- æ‹’ç»ç¤¼ç‰©
- ç¤¼ç‰©è¿‡æœŸå¤„ç†
```

#### 4ï¸âƒ£ å…¶ä»–å¤„ç†å™¨ - åŸºç¡€è¦†ç›– (1-2å¤©)

| æ–‡ä»¶ | å½“å‰ | ç›®æ ‡ | å·¥ä½œé‡ |
|------|------|------|--------|
| `admin/router.go` | 0% | 50% | 1h |
| `admin/stats.go` | 0% | 50% | 1h |
| `admin/system.go` | 0% | 50% | 1h |

### ç¬¬ä¸€éƒ¨åˆ†éªŒè¯æ¸…å•

```bash
# 1. è¿è¡Œæ‰€æœ‰å¤„ç†å™¨æµ‹è¯•
go test -v ./internal/handler/...

# 2. ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
go test -v -coverprofile=coverage.out ./internal/handler/...
go tool cover -func=coverage.out > handler_coverage.txt

# 3. æ£€æŸ¥è¦†ç›–ç‡
# æœŸæœ›: Handler å±‚ â‰¥50%
# æœŸæœ›: åç«¯æ•´ä½“ â‰¥55%

# 4. éªŒè¯æ— æ–°å¢å¤±è´¥
# æœŸæœ›: æ‰€æœ‰æµ‹è¯•é€šè¿‡
```

### ç¬¬ä¸€éƒ¨åˆ†æˆåŠŸæ ‡å‡†
- âœ… Handler å±‚è¦†ç›–ç‡ â‰¥50% (ä» 32-39%)
- âœ… åç«¯æ•´ä½“è¦†ç›–ç‡ â‰¥55% (ä» 49.5%)
- âœ… 7ä¸ªå¤„ç†å™¨æ–‡ä»¶è¦†ç›–ç‡ â‰¥60%
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œæ— æ–°å¢å¤±è´¥

### é¢„è®¡å·¥ä½œé‡
- **æ€»å·¥æ—¶**: 16-18 å°æ—¶
- **äººå‘˜**: 1-2 äºº
- **å·¥æœŸ**: 5-7 å¤©

---

## ğŸŸ¢ ç¬¬äºŒéƒ¨åˆ†: Service å±‚å…¨é¢å¢å¼º + Handler å±‚å®Œå–„ (1-2å‘¨)

### ç›®æ ‡
- Handler å±‚è¦†ç›–ç‡: 50% â†’ **65-70%**
- Service å±‚è¦†ç›–ç‡: 49-100% â†’ **70-95%**
- åç«¯æ•´ä½“è¦†ç›–ç‡: 55-60% â†’ **65-70%**

### å·¥ä½œåˆ†è§£

#### 1ï¸âƒ£ Handler å±‚å…¨é¢å®Œå–„ (3-4å¤©)

**ç®¡ç†ç«¯å¤„ç†å™¨å®Œå–„** (60% â†’ 80%+):

| æ–‡ä»¶ | å½“å‰ | ç›®æ ‡ | å¢å¼ºå†…å®¹ | å·¥ä½œé‡ |
|------|------|------|---------|--------|
| `admin/commission.go` | 60% | 80% | è¾¹ç•Œæƒ…å†µã€é”™è¯¯å¤„ç†ã€å¹¶å‘ | 2h |
| `admin/item.go` | 60% | 80% | è¾¹ç•Œæƒ…å†µã€é”™è¯¯å¤„ç†ã€å¹¶å‘ | 2h |
| `admin/ranking.go` | 60% | 80% | è¾¹ç•Œæƒ…å†µã€é”™è¯¯å¤„ç†ã€å¹¶å‘ | 2h |
| `admin/withdraw.go` | 60% | 80% | è¾¹ç•Œæƒ…å†µã€é”™è¯¯å¤„ç†ã€å¹¶å‘ | 2h |
| `admin/router.go` | 50% | 65% | è·¯ç”±é…ç½®ã€ä¸­é—´ä»¶ | 1.5h |
| `admin/stats.go` | 50% | 65% | ç»Ÿè®¡é€»è¾‘ã€æ•°æ®èšåˆ | 1.5h |
| `admin/system.go` | 50% | 65% | ç³»ç»Ÿæ“ä½œã€é…ç½®ç®¡ç† | 1.5h |

**ç”¨æˆ·ç«¯å¤„ç†å™¨å®Œå–„** (60-80% â†’ 85%+):

| æ–‡ä»¶ | å½“å‰ | ç›®æ ‡ | å¢å¼ºå†…å®¹ | å·¥ä½œé‡ |
|------|------|------|---------|--------|
| `user/gift.go` | 60% | 80% | è¾¹ç•Œæƒ…å†µã€é”™è¯¯å¤„ç† | 2h |
| `user/order.go` | 75% | 85% | è¾¹ç•Œæƒ…å†µã€å¹¶å‘ã€ç¼“å­˜ | 1.5h |
| `user/payment.go` | 85% | 90% | æ”¯ä»˜å¼‚å¸¸ã€è¶…æ—¶å¤„ç† | 1h |
| `user/player.go` | 55.6% | 80% | ç©å®¶æŸ¥è¯¢ã€è¿‡æ»¤ã€æ’åº | 2h |
| `user/review.go` | 57.9% | 80% | è¯„ä»·éªŒè¯ã€å®¡æ ¸æµç¨‹ | 2h |

**ç©å®¶ç«¯å¤„ç†å™¨å®Œå–„** (60-75% â†’ 85%+):

| æ–‡ä»¶ | å½“å‰ | ç›®æ ‡ | å¢å¼ºå†…å®¹ | å·¥ä½œé‡ |
|------|------|------|---------|--------|
| `player/commission.go` | 60% | 80% | æŸ¥è¯¢ä¼˜åŒ–ã€ç¼“å­˜ | 2h |
| `player/earnings.go` | 75% | 85% | ç»Ÿè®¡ä¼˜åŒ–ã€è¶‹åŠ¿åˆ†æ | 1.5h |
| `player/gift.go` | 60% | 80% | ç¤¼ç‰©è¿‡æœŸã€çŠ¶æ€è½¬æ¢ | 2h |
| `player/order.go` | 55.6% | 80% | è®¢å•æŸ¥è¯¢ã€è¿‡æ»¤ | 2h |
| `player/profile.go` | 77.8% | 90% | ä¸ªäººä¿¡æ¯æ›´æ–°ã€éªŒè¯ | 1.5h |

**å¢å¼ºæµ‹è¯•æ–¹å‘**:
```go
// 1. è¾¹ç•Œæƒ…å†µæµ‹è¯•
- ç©ºå€¼å¤„ç†
- è¶…å¤§å€¼å¤„ç†
- ç‰¹æ®Šå­—ç¬¦å¤„ç†
- è¶…æ—¶å¤„ç†

// 2. é”™è¯¯å¤„ç†æµ‹è¯•
- ä¸šåŠ¡å¼‚å¸¸ (ErrNotFound, ErrInvalidInput)
- æ•°æ®åº“å¼‚å¸¸ (è¿æ¥å¤±è´¥ã€è¶…æ—¶)
- å¤–éƒ¨æœåŠ¡å¼‚å¸¸ (æ”¯ä»˜ã€çŸ­ä¿¡)
- æƒé™å¼‚å¸¸ (æ— æƒé™ã€tokenè¿‡æœŸ)

// 3. å¹¶å‘æµ‹è¯•
- å¤šçº¿ç¨‹å¹¶å‘è®¿é—®
- ç«æ€æ¡ä»¶
- æ­»é”æ£€æµ‹

// 4. ç¼“å­˜ç›¸å…³æµ‹è¯•
- ç¼“å­˜å‘½ä¸­
- ç¼“å­˜å¤±æ•ˆ
- ç¼“å­˜æ›´æ–°
```

#### 2ï¸âƒ£ Service å±‚å¢å¼º (3-4å¤©)

**ä¼˜å…ˆçº§æ’åº**:

| æœåŠ¡ | å½“å‰ | ç›®æ ‡ | å·¥ä½œé‡ | å¢å¼ºå†…å®¹ |
|------|------|------|--------|---------|
| `service/commission` | 49.7% | 70% | 3h | ä½£é‡‘è®¡ç®—ã€å®¡æ ¸æµç¨‹ã€å¼‚å¸¸å¤„ç† |
| `service/admin` | 59.9% | 75% | 3h | ç®¡ç†æ“ä½œã€æƒé™æ£€æŸ¥ã€æ—¥å¿—å®¡è®¡ |
| `service/role` | 59.1% | 75% | 3h | è§’è‰²ç®¡ç†ã€æƒé™åˆ†é…ã€ç¼“å­˜ |
| `service/item` | 66.3% | 80% | 2h | ç‰©å“æ“ä½œã€åº“å­˜ç®¡ç†ã€éªŒè¯ |
| `service/auth` | 92.1% | 95% | 1h | è¾¹ç•Œæƒ…å†µã€å¼‚å¸¸å¤„ç† |

**å¢å¼ºæµ‹è¯•æ¨¡æ¿**:
```go
func TestCommissionService_CalculateCommission(t *testing.T) {
    // 1. å‡†å¤‡æ•°æ®
    mockRepo := &MockCommissionRepository{}
    service := NewCommissionService(mockRepo)
    
    // 2. æµ‹è¯•æ­£å¸¸åœºæ™¯
    t.Run("æ­£å¸¸è®¡ç®—ä½£é‡‘", func(t *testing.T) {
        result, err := service.CalculateCommission(100, 0.1)
        assert.NoError(t, err)
        assert.Equal(t, 10.0, result)
    })
    
    // 3. æµ‹è¯•è¾¹ç•Œæƒ…å†µ
    t.Run("é›¶ä½£é‡‘ç‡", func(t *testing.T) {
        result, err := service.CalculateCommission(100, 0)
        assert.NoError(t, err)
        assert.Equal(t, 0.0, result)
    })
    
    t.Run("è´Ÿæ•°é‡‘é¢", func(t *testing.T) {
        result, err := service.CalculateCommission(-100, 0.1)
        assert.Error(t, err)
    })
    
    // 4. æµ‹è¯•é”™è¯¯å¤„ç†
    t.Run("æ•°æ®åº“å¼‚å¸¸", func(t *testing.T) {
        mockRepo.On("GetCommission").Return(nil, errors.New("db error"))
        result, err := service.CalculateCommission(100, 0.1)
        assert.Error(t, err)
        assert.Nil(t, result)
    })
    
    // 5. æµ‹è¯•å¹¶å‘
    t.Run("å¹¶å‘è®¡ç®—", func(t *testing.T) {
        var wg sync.WaitGroup
        for i := 0; i < 100; i++ {
            wg.Add(1)
            go func() {
                defer wg.Done()
                service.CalculateCommission(100, 0.1)
            }()
        }
        wg.Wait()
    })
}
```

#### 3ï¸âƒ£ Repository å±‚ä¼˜åŒ– (1-2å¤©)

**å½“å‰çŠ¶æ€**: å¤§å¤šæ•° Repository è¦†ç›–ç‡å·² â‰¥80%

**ä¼˜åŒ–ç›®æ ‡**:

| æ¨¡å— | å½“å‰ | ç›®æ ‡ | å·¥ä½œé‡ |
|------|------|------|--------|
| `repository/permission` | 69% | 80% | 1h |
| `repository/role` | 74.5% | 85% | 1h |
| `repository/stats` | 76.1% | 85% | 1h |
| `repository/commission` | 78.2% | 85% | 1h |

**ä¼˜åŒ–æ–¹å‘**:
```go
// 1. å¤æ‚æŸ¥è¯¢æµ‹è¯•
- å¤šæ¡ä»¶æŸ¥è¯¢
- æ’åºå’Œåˆ†é¡µ
- èšåˆæ“ä½œ

// 2. äº‹åŠ¡æµ‹è¯•
- äº‹åŠ¡æäº¤
- äº‹åŠ¡å›æ»š
- åµŒå¥—äº‹åŠ¡

// 3. ç¼“å­˜é›†æˆæµ‹è¯•
- ç¼“å­˜å‘½ä¸­
- ç¼“å­˜å¤±æ•ˆ
- ç¼“å­˜æ›´æ–°
```

#### 4ï¸âƒ£ å…¶ä»–æ¨¡å—ä¼˜åŒ– (1-2å¤©)

| æ¨¡å— | å½“å‰ | ç›®æ ‡ | å·¥ä½œé‡ |
|------|------|------|--------|
| `internal/auth` | 60% | 75% | 1.5h |
| `internal/config` | 61.1% | 75% | 1.5h |
| `internal/cache` | 73.8% | 85% | 1.5h |
| `internal/db` | 66.8% | 80% | 1.5h |

### ç¬¬äºŒéƒ¨åˆ†éªŒè¯æ¸…å•

```bash
# 1. è¿è¡Œæ‰€æœ‰åç«¯æµ‹è¯•
go test -v ./...

# 2. ç”Ÿæˆå®Œæ•´è¦†ç›–ç‡æŠ¥å‘Š
go test -v -coverprofile=coverage.out ./...
go tool cover -func=coverage.out > backend_coverage_full.txt

# 3. æŒ‰æ¨¡å—æ£€æŸ¥è¦†ç›–ç‡
go tool cover -func=coverage.out | grep "handler"   # æœŸæœ› â‰¥65%
go tool cover -func=coverage.out | grep "service"   # æœŸæœ› â‰¥70%
go tool cover -func=coverage.out | grep "repository" # æœŸæœ› â‰¥80%

# 4. ç”Ÿæˆ HTML æŠ¥å‘Š
go tool cover -html=coverage.out -o coverage.html

# 5. éªŒè¯æ•´ä½“è¦†ç›–ç‡
# æœŸæœ›: åç«¯æ•´ä½“ â‰¥65%
```

### ç¬¬äºŒéƒ¨åˆ†æˆåŠŸæ ‡å‡†
- âœ… Handler å±‚è¦†ç›–ç‡ â‰¥65% (ä» 50%)
- âœ… Service å±‚è¦†ç›–ç‡ â‰¥70% (ä» 49-100%)
- âœ… Repository å±‚è¦†ç›–ç‡ â‰¥80% (ç»´æŒ)
- âœ… åç«¯æ•´ä½“è¦†ç›–ç‡ â‰¥65% (ä» 55-60%)
- âœ… æ‰€æœ‰å…³é”®æœåŠ¡è¦†ç›–ç‡ â‰¥75%
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œæ— æ–°å¢å¤±è´¥

### é¢„è®¡å·¥ä½œé‡
- **æ€»å·¥æ—¶**: 32-36 å°æ—¶
- **äººå‘˜**: 2-3 äºº
- **å·¥æœŸ**: 8-10 å¤©

---

## ğŸ“ˆ è¦†ç›–ç‡æå‡è·¯çº¿å›¾

### ç¬¬ä¸€éƒ¨åˆ†å®Œæˆå
```
Handler å±‚:    32-39% â†’ 50%+ âœ…
Service å±‚:    49-100% â†’ ä¸å˜
Repository å±‚: 66-100% â†’ ä¸å˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åç«¯æ•´ä½“:      49.5% â†’ 55-60% âœ…
```

### ç¬¬äºŒéƒ¨åˆ†å®Œæˆå
```
Handler å±‚:    50% â†’ 65-70% âœ…
Service å±‚:    49-100% â†’ 70-95% âœ…
Repository å±‚: 66-100% â†’ 80-100% âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åç«¯æ•´ä½“:      55-60% â†’ 65-70% âœ…
```

---

## ğŸ”§ æµ‹è¯•å·¥å…·å’Œé…ç½®

### å¿…è¦å·¥å…·
```bash
# å®‰è£… Mock å·¥å…·
go install github.com/golang/mock/mockgen@latest

# å®‰è£…è¦†ç›–ç‡åˆ†æå·¥å…·
go install github.com/axw/gocov/gocov@latest
go install github.com/AlekSi/gocov-xml@latest
```

### æ¨èçš„æµ‹è¯•é…ç½®
```go
// åœ¨ *_test.go æ–‡ä»¶ä¸­
import (
    "testing"
    "github.com/stretchr/testify/assert"
    "github.com/stretchr/testify/mock"
    "github.com/golang/mock/gomock"
)

// ä½¿ç”¨ testify è¿›è¡Œæ–­è¨€
// ä½¿ç”¨ gomock è¿›è¡Œ Mock ç”Ÿæˆ
// ä½¿ç”¨ mock è¿›è¡Œæ‰‹åŠ¨ Mock
```

### CI/CD é›†æˆ
```yaml
# .github/workflows/test.yml
name: Backend Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-go@v3
        with:
          go-version: 1.25.3
      - name: Run tests
        run: go test -v -coverprofile=coverage.out ./...
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage.out
          flags: backend
          fail_ci_if_error: true
```

---

## ğŸ“Š å·¥ä½œåˆ†é…å»ºè®®

### ç¬¬ä¸€éƒ¨åˆ† (1äºº, 5-7å¤©)
- **äººå‘˜**: 1 ååç«¯å·¥ç¨‹å¸ˆ
- **èŒè´£**: 
  - æ·»åŠ  7 ä¸ªå¤„ç†å™¨æ–‡ä»¶çš„åŸºç¡€æµ‹è¯•
  - é…ç½®æµ‹è¯•æ¡†æ¶å’Œ Mock
  - ç”Ÿæˆåˆå§‹è¦†ç›–ç‡æŠ¥å‘Š

### ç¬¬äºŒéƒ¨åˆ† (2-3äºº, 8-10å¤©)
- **äººå‘˜ A** (1äºº): Handler å±‚å®Œå–„ (3-4å¤©)
  - ç®¡ç†ç«¯ã€ç”¨æˆ·ç«¯ã€ç©å®¶ç«¯å¤„ç†å™¨å…¨é¢æµ‹è¯•
  
- **äººå‘˜ B** (1äºº): Service å±‚å¢å¼º (3-4å¤©)
  - 5 ä¸ªå…³é”®æœåŠ¡çš„æ·±åº¦æµ‹è¯•
  - è¾¹ç•Œæƒ…å†µå’Œé”™è¯¯å¤„ç†
  
- **äººå‘˜ C** (1äºº): Repository å±‚å’Œå…¶ä»–æ¨¡å— (1-2å¤©)
  - Repository å±‚ä¼˜åŒ–
  - å…¶ä»–æ¨¡å—è¦†ç›–ç‡æå‡

---

## âœ… æ£€æŸ¥æ¸…å•

### ç¬¬ä¸€éƒ¨åˆ†
- [ ] åˆ›å»º 7 ä¸ªå¤„ç†å™¨æµ‹è¯•æ–‡ä»¶
- [ ] å®ç°åŸºç¡€æµ‹è¯•ç”¨ä¾‹ (CRUD æ“ä½œ)
- [ ] éªŒè¯å¤„ç†å™¨è¦†ç›–ç‡ â‰¥50%
- [ ] éªŒè¯åç«¯æ•´ä½“è¦†ç›–ç‡ â‰¥55%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š

### ç¬¬äºŒéƒ¨åˆ†
- [ ] å®Œå–„ Handler å±‚æµ‹è¯• (17 ä¸ªæ–‡ä»¶)
- [ ] å¢å¼º Service å±‚æµ‹è¯• (5 ä¸ªæœåŠ¡)
- [ ] ä¼˜åŒ– Repository å±‚æµ‹è¯• (4 ä¸ªæ¨¡å—)
- [ ] æå‡å…¶ä»–æ¨¡å—è¦†ç›–ç‡
- [ ] éªŒè¯å¤„ç†å™¨è¦†ç›–ç‡ â‰¥65%
- [ ] éªŒè¯æœåŠ¡å±‚è¦†ç›–ç‡ â‰¥70%
- [ ] éªŒè¯åç«¯æ•´ä½“è¦†ç›–ç‡ â‰¥65%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ç”Ÿæˆæœ€ç»ˆè¦†ç›–ç‡æŠ¥å‘Š

---

## ğŸ“ å…³é”®æ–‡ä»¶æ¸…å•

### ç¬¬ä¸€éƒ¨åˆ†éœ€è¦åˆ›å»ºçš„æ–‡ä»¶
```
backend/internal/handler/admin/
  â”œâ”€â”€ commission_test.go (æ–°å»º)
  â”œâ”€â”€ item_test.go (æ–°å»º)
  â”œâ”€â”€ ranking_test.go (æ–°å»º)
  â”œâ”€â”€ withdraw_test.go (æ–°å»º)
  â”œâ”€â”€ router_test.go (æ–°å»º)
  â”œâ”€â”€ stats_test.go (æ–°å»º)
  â””â”€â”€ system_test.go (æ–°å»º)

backend/internal/handler/user/
  â””â”€â”€ gift_test.go (æ–°å»º)

backend/internal/handler/player/
  â”œâ”€â”€ commission_test.go (æ–°å»º)
  â””â”€â”€ gift_test.go (æ–°å»º)
```

### ç¬¬äºŒéƒ¨åˆ†éœ€è¦å¢å¼ºçš„æ–‡ä»¶
```
backend/internal/handler/ (17 ä¸ªæ–‡ä»¶å¢å¼º)
backend/internal/service/ (5 ä¸ªæ–‡ä»¶å¢å¼º)
backend/internal/repository/ (4 ä¸ªæ–‡ä»¶ä¼˜åŒ–)
backend/internal/ (å…¶ä»–æ¨¡å—ä¼˜åŒ–)
```

---

## ğŸ¯ æˆåŠŸæ ‡å‡†æ€»ç»“

| é˜¶æ®µ | æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | çŠ¶æ€ |
|------|------|------|------|------|
| **ç¬¬ä¸€éƒ¨åˆ†** | Handler è¦†ç›–ç‡ | 32-39% | 50%+ | â¬œ |
| | åç«¯æ•´ä½“ | 49.5% | 55-60% | â¬œ |
| | æµ‹è¯•é€šè¿‡ç‡ | 100% | 100% | â¬œ |
| **ç¬¬äºŒéƒ¨åˆ†** | Handler è¦†ç›–ç‡ | 50% | 65-70% | â¬œ |
| | Service è¦†ç›–ç‡ | 49-100% | 70-95% | â¬œ |
| | åç«¯æ•´ä½“ | 55-60% | 65-70% | â¬œ |
| | æ•´ä½“è¯„çº§ | B+ | A- | â¬œ |

---

**ä¸‹ä¸€æ­¥**: é€‰æ‹©ç¬¬ä¸€éƒ¨åˆ†æˆ–ç¬¬äºŒéƒ¨åˆ†å¼€å§‹å·¥ä½œï¼ŒæŒ‰ç…§è¯¦ç»†è®¡åˆ’é€é¡¹å®Œæˆã€‚
