# ğŸš€ GameLink 9å‘¨å®Œæ•´å¼€å‘è®¡åˆ’

## ğŸ“Š å½“å‰çŠ¶æ€
- **åŠŸèƒ½å®Œæ•´åº¦**: 75%
- **æµ‹è¯•è¦†ç›–ç‡**: 65.66%
- **é¡¹ç›®è¯„çº§**: B+ (è‰¯å¥½)

## ğŸ¯ ç›®æ ‡çŠ¶æ€
- **åŠŸèƒ½å®Œæ•´åº¦**: 95%
- **æµ‹è¯•è¦†ç›–ç‡**: 80%+
- **é¡¹ç›®è¯„çº§**: A (ä¼˜ç§€)

---

## ğŸ“… Phase 1: æµ‹è¯•è¦†ç›–ç‡æå‡ (Week 1)

### ğŸ¯ ç›®æ ‡
- æµ‹è¯•è¦†ç›–ç‡: 65.66% â†’ 80%+
- Handlerå±‚: 43% â†’ 70%+
- Serviceå±‚: 72% â†’ 85%+

### ğŸ“‹ ä»»åŠ¡æ¸…å•

#### Day 1-2: Admin Handleræµ‹è¯•
```bash
âœ… ranking_test.go - æ’è¡Œæ¦œç®¡ç†æµ‹è¯•
â¬œ è¡¥å……commission_test.goå®Œæ•´åœºæ™¯
â¬œ è¡¥å……withdraw_test.goå®Œæ•´åœºæ™¯
â¬œ è¡¥å……item_test.goå®Œæ•´åœºæ™¯
â¬œ åˆ›å»ºstatså®Œæ•´æµ‹è¯•
â¬œ åˆ›å»ºsystemå®Œæ•´æµ‹è¯•
```

**é¢„æœŸæˆæœ**: admin handler 32.6% â†’ 60%+

#### Day 3-4: User Handleræµ‹è¯•
```bash
â¬œ æ‰©å±•order_test.go
   - è®¢å•åˆ›å»ºè¾¹ç•Œæ¡ä»¶
   - è®¢å•å–æ¶ˆå„ç§çŠ¶æ€
   - è®¢å•å®Œæˆæµç¨‹
   - è®¢å•åˆ—è¡¨ç­›é€‰
â¬œ æ‰©å±•payment_test.go
   - æ”¯ä»˜åˆ›å»º
   - æ”¯ä»˜å›è°ƒå¤„ç†
   - æ”¯ä»˜å¤±è´¥åœºæ™¯
   - é€€æ¬¾æµç¨‹
â¬œ æ‰©å±•review_test.go
   - è¯„ä»·åˆ›å»º
   - è¯„ä»·ç¼–è¾‘
   - è¯„ä»·åˆ é™¤
   - è¯„ä»·æŸ¥è¯¢
â¬œ æ‰©å±•player_test.go
   - ç©å®¶æŸ¥è¯¢
   - ç©å®¶ç­›é€‰
   - æ¸¸æˆç­›é€‰
```

**é¢„æœŸæˆæœ**: user handler 39.3% â†’ 65%+

#### Day 5-6: Player Handleræµ‹è¯•
```bash
â¬œ æ‰©å±•order_test.go
   - æ¥å•æµç¨‹
   - æ‹’å•åœºæ™¯
   - å¼€å§‹æœåŠ¡
   - å®ŒæˆæœåŠ¡
â¬œ æ‰©å±•earnings_test.go
   - æ”¶ç›ŠæŸ¥è¯¢
   - æ”¶ç›Šç»Ÿè®¡
   - æç°ç”³è¯·
   - æç°è®°å½•
â¬œ æ‰©å±•profile_test.go
   - èµ„æ–™æ›´æ–°
   - è®¤è¯ç”³è¯·
   - çŠ¶æ€ç®¡ç†
â¬œ åˆ›å»ºgift_test.go
   - ç¤¼ç‰©æ¥æ”¶
   - ç¤¼ç‰©ç»Ÿè®¡
```

**é¢„æœŸæˆæœ**: player handler 39.1% â†’ 65%+

#### Day 7: Serviceå±‚æµ‹è¯•è¡¥å……
```bash
â¬œ commission_test.go
   - ä¸‰å±‚æŠ½æˆè®¡ç®—
   - è¾¹ç•Œæ¡ä»¶æµ‹è¯•
   - æœˆåº¦ç»“ç®—
â¬œ role_test.go
   - æƒé™ç»§æ‰¿
   - è§’è‰²å†²çªæ£€æµ‹
â¬œ admin_test.go
   - æ‰¹é‡æ“ä½œ
   - å®¡è®¡æ—¥å¿—
```

**é¢„æœŸæˆæœ**: Serviceå±‚ 72% â†’ 85%+

### âœ… éªŒæ”¶æ ‡å‡†
- [ ] æ€»ä½“è¦†ç›–ç‡ â‰¥ 80%
- [ ] Handlerå±‚å¹³å‡ â‰¥ 65%
- [ ] Serviceå±‚å¹³å‡ â‰¥ 85%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ— ç¼–è¯‘é”™è¯¯

---

## ğŸ”’ Phase 2: å®‰å…¨å¢å¼º (Week 2)

### ğŸ¯ ç›®æ ‡
- **æ”¯ä»˜å®‰å…¨ä¼˜åŒ–** (åŸºäºDay 4æµ‹è¯•å‘ç°)
- å®ç°CSRFä¿æŠ¤
- å®ç°APIé™æµ
- å®ç°æ–‡ä»¶ä¸Šä¼ å®‰å…¨
- åŠ å¼ºè¾“å…¥éªŒè¯

### ğŸ“‹ ä»»åŠ¡æ¸…å•

#### Day 1-2: æ”¯ä»˜å®‰å…¨ä¼˜åŒ– â­ NEW
```go
// åŸºäºPhase 1 Day 4æµ‹è¯•å‘ç°çš„é—®é¢˜
â¬œ P0: 0å…ƒæ”¯ä»˜éªŒè¯ (30åˆ†é’Ÿ)
   - æ·»åŠ é‡‘é¢èŒƒå›´éªŒè¯
   - æœ€å°é‡‘é¢: 1åˆ†
   - æœ€å¤§é‡‘é¢: 100ä¸‡å…ƒ
   - å•å…ƒæµ‹è¯•

â¬œ P0: ç­¾åéªŒè¯ (2å°æ—¶)
   - å®ç°å¾®ä¿¡ç­¾åéªŒè¯
   - å®ç°æ”¯ä»˜å®ç­¾åéªŒè¯
   - é›†æˆåˆ°å›è°ƒå¤„ç†
   - å®‰å…¨æµ‹è¯•

â¬œ P0: äº‹åŠ¡ä¿æŠ¤ (3å°æ—¶)
   - Repositoryå±‚æ·»åŠ äº‹åŠ¡æ”¯æŒ
   - é‡æ„å›è°ƒå¤„ç†é€»è¾‘
   - ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
   - å¹¶å‘æµ‹è¯•

â¬œ P1: è¶…æ—¶å¤„ç† (4å°æ—¶)
   - å®ç°å®šæ—¶ä»»åŠ¡æ¸…ç†è¶…æ—¶æ”¯ä»˜
   - è‡ªåŠ¨å–æ¶ˆè¶…æ—¶è®¢å•
   - é…ç½®è¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤30åˆ†é’Ÿï¼‰
   - ç›‘æ§å’Œå‘Šè­¦
```

**å‚è€ƒæ–‡æ¡£**: `Paymentä¼˜åŒ–ä»»åŠ¡æ¸…å•.md`

**ä»£ç ç»“æ„**:
```go
// internal/service/payment/payment.go
func (s *PaymentService) CreatePayment(...) {
    // æ·»åŠ é‡‘é¢éªŒè¯
    if err := validatePaymentAmount(order.TotalPriceCents); err != nil {
        return nil, err
    }
}

func (s *PaymentService) HandlePaymentCallback(...) {
    // 1. éªŒè¯ç­¾å
    if err := s.validator.ValidateSignature(provider, data); err != nil {
        return err
    }
    
    // 2. ä½¿ç”¨äº‹åŠ¡å¤„ç†
    return s.db.Transaction(func(tx *gorm.DB) error {
        // æ›´æ–°æ”¯ä»˜å’Œè®¢å•çŠ¶æ€
    })
}

// å®šæ—¶ä»»åŠ¡
func (s *PaymentService) CleanupExpiredPayments(ctx context.Context) error {
    // æ¸…ç†è¶…æ—¶æ”¯ä»˜
}
```

#### Day 3-4: CSRFä¿æŠ¤
```go
// æ–‡ä»¶: internal/middleware/csrf.go
â¬œ å®ç°CSRF tokenç”Ÿæˆ
â¬œ å®ç°CSRFéªŒè¯ä¸­é—´ä»¶
â¬œ é›†æˆåˆ°è·¯ç”±
â¬œ ç¼–å†™æµ‹è¯•ç”¨ä¾‹
```

**ä»£ç ç»“æ„**:
```go
package middleware

type CSRFConfig struct {
    TokenLength int
    CookieName  string
    HeaderName  string
    Secret      string
}

func CSRF(config CSRFConfig) gin.HandlerFunc {
    // å®ç°CSRFä¿æŠ¤
}
```

#### Day 3-4: APIé™æµ
```go
// æ–‡ä»¶: internal/middleware/ratelimit.go
â¬œ å®ç°åŸºäºIPçš„é™æµ
â¬œ å®ç°åŸºäºç”¨æˆ·çš„é™æµ
â¬œ å®ç°æ»‘åŠ¨çª—å£ç®—æ³•
â¬œ Rediså­˜å‚¨é™æµæ•°æ®
â¬œ ç¼–å†™æµ‹è¯•ç”¨ä¾‹
```

**ä»£ç ç»“æ„**:
```go
package middleware

type RateLimitConfig struct {
    RequestsPerMinute int
    BurstSize         int
    KeyFunc           func(*gin.Context) string
}

func RateLimit(config RateLimitConfig) gin.HandlerFunc {
    // å®ç°é™æµ
}
```

#### Day 5-7: æ–‡ä»¶ä¸Šä¼ å®‰å…¨
```go
// æ–‡ä»¶: internal/handler/upload/upload.go
â¬œ å®ç°æ–‡ä»¶ä¸Šä¼ handler
â¬œ æ–‡ä»¶ç±»å‹éªŒè¯ (ç™½åå•)
â¬œ æ–‡ä»¶å¤§å°é™åˆ¶
â¬œ æ–‡ä»¶åéšæœºåŒ–
â¬œ ç—…æ¯’æ‰«æé›†æˆ (å¯é€‰)
â¬œ å­˜å‚¨åˆ°OSS (é˜¿é‡Œäº‘/ä¸ƒç‰›)
â¬œ ç¼–å†™æµ‹è¯•ç”¨ä¾‹
```

**æ•°æ®åº“è®¾è®¡**:
```sql
CREATE TABLE uploads (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    file_name VARCHAR(255) NOT NULL,
    file_path VARCHAR(500) NOT NULL,
    file_size BIGINT NOT NULL,
    mime_type VARCHAR(100) NOT NULL,
    upload_type VARCHAR(50) NOT NULL, -- avatar, certification, etc
    status VARCHAR(20) DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_id (user_id),
    INDEX idx_upload_type (upload_type)
);
```

### âœ… éªŒæ”¶æ ‡å‡†
- [ ] **æ”¯ä»˜å®‰å…¨**: 0å…ƒéªŒè¯ã€ç­¾åéªŒè¯ã€äº‹åŠ¡ä¿æŠ¤ã€è¶…æ—¶å¤„ç†å…¨éƒ¨å®ç°
- [ ] **æ”¯ä»˜æµ‹è¯•**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€å®‰å…¨æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] CSRFä¿æŠ¤æ­£å¸¸å·¥ä½œ
- [ ] APIé™æµæœ‰æ•ˆé˜²æ­¢åˆ·æ¥å£
- [ ] æ–‡ä»¶ä¸Šä¼ å®‰å…¨å¯é 
- [ ] æ‰€æœ‰å®‰å…¨æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨æ–‡æ¡£å®Œå–„

### ğŸ“Š æ”¯ä»˜å®‰å…¨æå‡
```
å®‰å…¨ç­‰çº§: â­â­â­â˜†â˜† (3/5) â†’ â­â­â­â­â­ (5/5)
æ•°æ®ä¸€è‡´æ€§: â­â­â­â˜†â˜† (3/5) â†’ â­â­â­â­â­ (5/5)
ç”¨æˆ·ä½“éªŒ: â­â­â­â­â˜† (4/5) â†’ â­â­â­â­â­ (5/5)
```

---

## ğŸ’ Phase 3: ä¼šå‘˜è®¢é˜…ç³»ç»Ÿ (Week 3-4)

### ğŸ¯ ç›®æ ‡
- å®ç°ç”¨æˆ·VIPä¼šå‘˜
- å®ç°é™ªç©å¸ˆè®¤è¯ä¼šå‘˜
- å®ç°è‡ªåŠ¨ç»­è´¹
- å®ç°ä¼šå‘˜æƒç›Šç®¡ç†

### ğŸ“‹ ä»»åŠ¡æ¸…å•

#### Week 3 Day 1-3: æ•°æ®åº“è®¾è®¡ä¸Model
```sql
-- ä¼šå‘˜ç­‰çº§è¡¨
CREATE TABLE membership_tiers (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    type VARCHAR(20) NOT NULL, -- user_vip, player_certified
    price_cents INT NOT NULL,
    duration_days INT NOT NULL,
    benefits JSON NOT NULL,
    sort_order INT DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- ä¼šå‘˜è®¢é˜…è¡¨
CREATE TABLE memberships (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    tier_id BIGINT NOT NULL,
    start_date TIMESTAMP NOT NULL,
    end_date TIMESTAMP NOT NULL,
    status VARCHAR(20) DEFAULT 'active', -- active, expired, cancelled
    auto_renew BOOLEAN DEFAULT FALSE,
    payment_method VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_user_id (user_id),
    INDEX idx_status (status),
    INDEX idx_end_date (end_date)
);

-- ä¼šå‘˜æƒç›Šè¡¨
CREATE TABLE membership_benefits (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tier_id BIGINT NOT NULL,
    benefit_key VARCHAR(100) NOT NULL,
    benefit_value VARCHAR(500) NOT NULL,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_tier_id (tier_id)
);
```

**Modelå®šä¹‰**:
```go
// internal/model/membership.go
â¬œ MembershipTier model
â¬œ Membership model
â¬œ MembershipBenefit model
```

#### Week 3 Day 4-7: Repositoryå±‚
```go
// internal/repository/membership/membership.go
â¬œ å®ç°MembershipRepositoryæ¥å£
â¬œ CreateTier - åˆ›å»ºä¼šå‘˜ç­‰çº§
â¬œ GetTier - è·å–ä¼šå‘˜ç­‰çº§
â¬œ ListTiers - åˆ—å‡ºä¼šå‘˜ç­‰çº§
â¬œ UpdateTier - æ›´æ–°ä¼šå‘˜ç­‰çº§
â¬œ CreateMembership - åˆ›å»ºä¼šå‘˜è®¢é˜…
â¬œ GetUserMembership - è·å–ç”¨æˆ·ä¼šå‘˜
â¬œ UpdateMembership - æ›´æ–°ä¼šå‘˜çŠ¶æ€
â¬œ ListExpiringMemberships - è·å–å³å°†è¿‡æœŸçš„ä¼šå‘˜
â¬œ ç¼–å†™å®Œæ•´æµ‹è¯• (ç›®æ ‡è¦†ç›–ç‡90%+)
```

#### Week 4 Day 1-4: Serviceå±‚
```go
// internal/service/membership/membership.go
â¬œ å®ç°MembershipService
â¬œ Subscribe - è®¢é˜…ä¼šå‘˜
â¬œ Renew - ç»­è´¹ä¼šå‘˜
â¬œ Cancel - å–æ¶ˆä¼šå‘˜
â¬œ CheckBenefit - æ£€æŸ¥æƒç›Š
â¬œ AutoRenewTask - è‡ªåŠ¨ç»­è´¹ä»»åŠ¡
â¬œ ExpireTask - è¿‡æœŸå¤„ç†ä»»åŠ¡
â¬œ ç¼–å†™å®Œæ•´æµ‹è¯• (ç›®æ ‡è¦†ç›–ç‡85%+)
```

**ä¸šåŠ¡é€»è¾‘**:
```go
// è®¢é˜…æµç¨‹
1. é€‰æ‹©ä¼šå‘˜ç­‰çº§
2. åˆ›å»ºæ”¯ä»˜è®¢å•
3. æ”¯ä»˜æˆåŠŸå›è°ƒ
4. æ¿€æ´»ä¼šå‘˜
5. å‘é€é€šçŸ¥

// è‡ªåŠ¨ç»­è´¹æµç¨‹
1. å®šæ—¶ä»»åŠ¡æ‰«æå³å°†è¿‡æœŸçš„ä¼šå‘˜
2. æ£€æŸ¥auto_renewæ ‡å¿—
3. åˆ›å»ºç»­è´¹è®¢å•
4. æ‰£æ¬¾
5. å»¶é•¿ä¼šå‘˜æœŸé™
```

#### Week 4 Day 5-7: Handlerå±‚ä¸å‰ç«¯API
```go
// internal/handler/user/membership.go
â¬œ ListTiers - è·å–ä¼šå‘˜ç­‰çº§åˆ—è¡¨
â¬œ Subscribe - è®¢é˜…ä¼šå‘˜
â¬œ GetMyMembership - è·å–æˆ‘çš„ä¼šå‘˜
â¬œ CancelAutoRenew - å–æ¶ˆè‡ªåŠ¨ç»­è´¹
â¬œ EnableAutoRenew - å¼€å¯è‡ªåŠ¨ç»­è´¹

// internal/handler/admin/membership.go
â¬œ CreateTier - åˆ›å»ºä¼šå‘˜ç­‰çº§
â¬œ UpdateTier - æ›´æ–°ä¼šå‘˜ç­‰çº§
â¬œ ListMemberships - æŸ¥çœ‹æ‰€æœ‰ä¼šå‘˜
â¬œ GetMembershipStats - ä¼šå‘˜ç»Ÿè®¡
â¬œ ç¼–å†™å®Œæ•´æµ‹è¯•
```

### âœ… éªŒæ”¶æ ‡å‡†
- [ ] æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ
- [ ] Repositoryå±‚æµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%
- [ ] Serviceå±‚æµ‹è¯•è¦†ç›–ç‡ â‰¥ 85%
- [ ] Handlerå±‚æµ‹è¯•è¦†ç›–ç‡ â‰¥ 70%
- [ ] è®¢é˜…æµç¨‹å®Œæ•´å¯ç”¨
- [ ] è‡ªåŠ¨ç»­è´¹åŠŸèƒ½æ­£å¸¸
- [ ] APIæ–‡æ¡£å®Œå–„

---

## ğŸ’¬ Phase 4: å®æ—¶èŠå¤©åŠŸèƒ½ (Week 5-6)

### ğŸ¯ ç›®æ ‡
- å®ç°WebSocketæœåŠ¡
- å®ç°æ¶ˆæ¯å­˜å‚¨
- å®ç°ç¦»çº¿æ¶ˆæ¯
- å®ç°æ¶ˆæ¯æ¨é€

### ğŸ“‹ ä»»åŠ¡æ¸…å•

#### Week 5 Day 1-3: WebSocketæœåŠ¡
```go
// internal/websocket/hub.go
â¬œ å®ç°WebSocket Hub
â¬œ å®¢æˆ·ç«¯è¿æ¥ç®¡ç†
â¬œ æ¶ˆæ¯å¹¿æ’­
â¬œ å¿ƒè·³æ£€æµ‹
â¬œ æ–­çº¿é‡è¿

// internal/websocket/client.go
â¬œ å®ç°Clientç»“æ„
â¬œ æ¶ˆæ¯å‘é€
â¬œ æ¶ˆæ¯æ¥æ”¶
â¬œ è¿æ¥çŠ¶æ€ç®¡ç†
```

**æŠ€æœ¯é€‰å‹**:
```go
// ä½¿ç”¨gorilla/websocket
import "github.com/gorilla/websocket"

type Hub struct {
    clients    map[uint64]*Client
    broadcast  chan *Message
    register   chan *Client
    unregister chan *Client
}

type Client struct {
    hub    *Hub
    conn   *websocket.Conn
    userID uint64
    send   chan []byte
}
```

#### Week 5 Day 4-7: æ¶ˆæ¯å­˜å‚¨
```sql
-- èŠå¤©æ¶ˆæ¯è¡¨
CREATE TABLE chat_messages (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    conversation_id BIGINT NOT NULL,
    sender_id BIGINT NOT NULL,
    receiver_id BIGINT NOT NULL,
    message_type VARCHAR(20) DEFAULT 'text', -- text, image, voice
    content TEXT NOT NULL,
    is_read BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_conversation (conversation_id),
    INDEX idx_sender (sender_id),
    INDEX idx_receiver (receiver_id),
    INDEX idx_created (created_at)
);

-- ä¼šè¯è¡¨
CREATE TABLE conversations (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    order_id BIGINT,
    user_id BIGINT NOT NULL,
    player_id BIGINT NOT NULL,
    last_message TEXT,
    last_message_at TIMESTAMP,
    unread_count INT DEFAULT 0,
    status VARCHAR(20) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_user_id (user_id),
    INDEX idx_player_id (player_id),
    INDEX idx_order_id (order_id)
);
```

```go
// internal/repository/chat/chat.go
â¬œ å®ç°ChatRepository
â¬œ CreateMessage - åˆ›å»ºæ¶ˆæ¯
â¬œ GetMessages - è·å–æ¶ˆæ¯åˆ—è¡¨
â¬œ MarkAsRead - æ ‡è®°å·²è¯»
â¬œ GetConversation - è·å–ä¼šè¯
â¬œ ListConversations - è·å–ä¼šè¯åˆ—è¡¨
â¬œ UpdateConversation - æ›´æ–°ä¼šè¯
```

#### Week 6 Day 1-4: Serviceå±‚ä¸Handler
```go
// internal/service/chat/chat.go
â¬œ å®ç°ChatService
â¬œ SendMessage - å‘é€æ¶ˆæ¯
â¬œ GetHistory - è·å–å†å²æ¶ˆæ¯
â¬œ GetConversations - è·å–ä¼šè¯åˆ—è¡¨
â¬œ MarkRead - æ ‡è®°å·²è¯»
â¬œ ç¦»çº¿æ¶ˆæ¯å¤„ç†

// internal/handler/chat/chat.go
â¬œ WebSocketè¿æ¥endpoint
â¬œ è·å–å†å²æ¶ˆæ¯API
â¬œ è·å–ä¼šè¯åˆ—è¡¨API
â¬œ æ ‡è®°å·²è¯»API
```

#### Week 6 Day 5-7: æ¶ˆæ¯æ¨é€ä¸æµ‹è¯•
```go
â¬œ é›†æˆæ¨é€æœåŠ¡ (æå…‰æ¨é€/Firebase)
â¬œ ç¦»çº¿æ¶ˆæ¯æ¨é€
â¬œ æ¶ˆæ¯æé†’
â¬œ ç¼–å†™å®Œæ•´æµ‹è¯•
â¬œ æ€§èƒ½æµ‹è¯• (æ”¯æŒ1000+å¹¶å‘è¿æ¥)
```

### âœ… éªŒæ”¶æ ‡å‡†
- [ ] WebSocketæœåŠ¡ç¨³å®šè¿è¡Œ
- [ ] æ¶ˆæ¯å®æ—¶æ”¶å‘æ­£å¸¸
- [ ] ç¦»çº¿æ¶ˆæ¯æ­£å¸¸å­˜å‚¨å’Œæ¨é€
- [ ] æ”¯æŒ1000+å¹¶å‘è¿æ¥
- [ ] æ¶ˆæ¯ä¸ä¸¢å¤±
- [ ] æµ‹è¯•è¦†ç›–ç‡ â‰¥ 75%

---

## ğŸ Phase 5: è¥é”€å·¥å…·ç³»ç»Ÿ (Week 7-8)

### ğŸ¯ ç›®æ ‡
- å®ç°ä¼˜æƒ åˆ¸ç³»ç»Ÿ
- å®ç°æ´»åŠ¨é…ç½®
- å®ç°æ¨é€é€šçŸ¥
- å®ç°è¥é”€æ•°æ®ç»Ÿè®¡

### ğŸ“‹ ä»»åŠ¡æ¸…å•

#### Week 7 Day 1-4: ä¼˜æƒ åˆ¸ç³»ç»Ÿ
```sql
-- ä¼˜æƒ åˆ¸æ¨¡æ¿è¡¨
CREATE TABLE coupon_templates (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    type VARCHAR(20) NOT NULL, -- discount, cashback, gift
    discount_type VARCHAR(20), -- percentage, fixed
    discount_value INT NOT NULL,
    min_order_amount INT DEFAULT 0,
    max_discount_amount INT,
    total_quantity INT NOT NULL,
    remaining_quantity INT NOT NULL,
    valid_from TIMESTAMP NOT NULL,
    valid_to TIMESTAMP NOT NULL,
    applicable_games JSON,
    applicable_players JSON,
    status VARCHAR(20) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_status (status),
    INDEX idx_valid_period (valid_from, valid_to)
);

-- ç”¨æˆ·ä¼˜æƒ åˆ¸è¡¨
CREATE TABLE user_coupons (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    template_id BIGINT NOT NULL,
    coupon_code VARCHAR(50) UNIQUE NOT NULL,
    status VARCHAR(20) DEFAULT 'unused', -- unused, used, expired
    used_at TIMESTAMP,
    order_id BIGINT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_id (user_id),
    INDEX idx_coupon_code (coupon_code),
    INDEX idx_status (status)
);
```

```go
// internal/service/coupon/coupon.go
â¬œ å®ç°CouponService
â¬œ CreateTemplate - åˆ›å»ºä¼˜æƒ åˆ¸æ¨¡æ¿
â¬œ IssueCoupon - å‘æ”¾ä¼˜æƒ åˆ¸
â¬œ UseCoupon - ä½¿ç”¨ä¼˜æƒ åˆ¸
â¬œ ValidateCoupon - éªŒè¯ä¼˜æƒ åˆ¸
â¬œ GetUserCoupons - è·å–ç”¨æˆ·ä¼˜æƒ åˆ¸
â¬œ CalculateDiscount - è®¡ç®—æŠ˜æ‰£
```

#### Week 7 Day 5-7: æ´»åŠ¨é…ç½®
```sql
-- è¥é”€æ´»åŠ¨è¡¨
CREATE TABLE marketing_campaigns (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    type VARCHAR(50) NOT NULL, -- new_user, recharge, invite
    description TEXT,
    rules JSON NOT NULL,
    rewards JSON NOT NULL,
    start_time TIMESTAMP NOT NULL,
    end_time TIMESTAMP NOT NULL,
    status VARCHAR(20) DEFAULT 'draft',
    created_by BIGINT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_type (type),
    INDEX idx_status (status),
    INDEX idx_time_range (start_time, end_time)
);

-- æ´»åŠ¨å‚ä¸è®°å½•
CREATE TABLE campaign_participations (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    campaign_id BIGINT NOT NULL,
    user_id BIGINT NOT NULL,
    reward_type VARCHAR(50),
    reward_value VARCHAR(200),
    status VARCHAR(20) DEFAULT 'pending',
    completed_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_campaign_id (campaign_id),
    INDEX idx_user_id (user_id)
);
```

```go
// internal/service/campaign/campaign.go
â¬œ å®ç°CampaignService
â¬œ CreateCampaign - åˆ›å»ºæ´»åŠ¨
â¬œ ParticipateInCampaign - å‚ä¸æ´»åŠ¨
â¬œ CheckEligibility - æ£€æŸ¥èµ„æ ¼
â¬œ DistributeReward - å‘æ”¾å¥–åŠ±
â¬œ GetCampaignStats - æ´»åŠ¨ç»Ÿè®¡
```

#### Week 8 Day 1-4: æ¨é€é€šçŸ¥
```sql
-- é€šçŸ¥æ¨¡æ¿è¡¨
CREATE TABLE notification_templates (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    type VARCHAR(50) NOT NULL, -- order, payment, system
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    variables JSON,
    channels JSON, -- push, sms, email
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- é€šçŸ¥è®°å½•è¡¨
CREATE TABLE notifications (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    template_id BIGINT,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    type VARCHAR(50) NOT NULL,
    channel VARCHAR(20) NOT NULL,
    status VARCHAR(20) DEFAULT 'pending',
    sent_at TIMESTAMP,
    read_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_id (user_id),
    INDEX idx_status (status),
    INDEX idx_type (type)
);
```

```go
// internal/service/notification/notification.go
â¬œ å®ç°NotificationService
â¬œ SendNotification - å‘é€é€šçŸ¥
â¬œ SendBulkNotification - æ‰¹é‡å‘é€
â¬œ GetUserNotifications - è·å–ç”¨æˆ·é€šçŸ¥
â¬œ MarkAsRead - æ ‡è®°å·²è¯»
â¬œ é›†æˆç¬¬ä¸‰æ–¹æ¨é€æœåŠ¡
```

#### Week 8 Day 5-7: Handlerä¸æµ‹è¯•
```go
// internal/handler/admin/marketing.go
â¬œ ä¼˜æƒ åˆ¸ç®¡ç†API
â¬œ æ´»åŠ¨ç®¡ç†API
â¬œ é€šçŸ¥ç®¡ç†API
â¬œ è¥é”€æ•°æ®ç»Ÿè®¡API

// internal/handler/user/marketing.go
â¬œ è·å–å¯ç”¨ä¼˜æƒ åˆ¸
â¬œ é¢†å–ä¼˜æƒ åˆ¸
â¬œ å‚ä¸æ´»åŠ¨
â¬œ è·å–é€šçŸ¥åˆ—è¡¨

â¬œ ç¼–å†™å®Œæ•´æµ‹è¯•
â¬œ é›†æˆæµ‹è¯•
```

### âœ… éªŒæ”¶æ ‡å‡†
- [ ] ä¼˜æƒ åˆ¸ç³»ç»Ÿå®Œæ•´å¯ç”¨
- [ ] æ´»åŠ¨é…ç½®çµæ´»
- [ ] æ¨é€é€šçŸ¥ç¨³å®š
- [ ] è¥é”€æ•°æ®ç»Ÿè®¡å‡†ç¡®
- [ ] æµ‹è¯•è¦†ç›–ç‡ â‰¥ 75%

---

## âš¡ Phase 6: æ€§èƒ½ä¼˜åŒ–ä¸ç›‘æ§ (Week 9)

### ğŸ¯ ç›®æ ‡
- å®ç°Redisç¼“å­˜ç­–ç•¥
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- å®ç°ç›‘æ§å‘Šè­¦
- æ€§èƒ½æµ‹è¯•

### ğŸ“‹ ä»»åŠ¡æ¸…å•

#### Day 1-3: ç¼“å­˜ä¼˜åŒ–
```go
// internal/cache/strategy.go
â¬œ ç©å®¶åˆ—è¡¨ç¼“å­˜ (5åˆ†é’Ÿ)
â¬œ æ¸¸æˆåˆ—è¡¨ç¼“å­˜ (30åˆ†é’Ÿ)
â¬œ ç”¨æˆ·ä¿¡æ¯ç¼“å­˜ (10åˆ†é’Ÿ)
â¬œ çƒ­é—¨æ•°æ®ç¼“å­˜
â¬œ ç¼“å­˜é¢„çƒ­
â¬œ ç¼“å­˜ç©¿é€é˜²æŠ¤
â¬œ ç¼“å­˜é›ªå´©é˜²æŠ¤
```

**ç¼“å­˜ç­–ç•¥**:
```go
// å¤šçº§ç¼“å­˜
1. æœ¬åœ°ç¼“å­˜ (go-cache) - çƒ­ç‚¹æ•°æ®
2. Redisç¼“å­˜ - å…±äº«æ•°æ®
3. æ•°æ®åº“ - æŒä¹…åŒ–æ•°æ®

// ç¼“å­˜æ›´æ–°ç­–ç•¥
1. ä¸»åŠ¨æ›´æ–° - æ•°æ®å˜æ›´æ—¶
2. è¢«åŠ¨æ›´æ–° - ç¼“å­˜è¿‡æœŸæ—¶
3. å®šæ—¶æ›´æ–° - å®šæ—¶ä»»åŠ¡
```

#### Day 4-5: æ•°æ®åº“ä¼˜åŒ–
```sql
â¬œ æ·»åŠ å¿…è¦çš„ç´¢å¼•
â¬œ ä¼˜åŒ–æ…¢æŸ¥è¯¢
â¬œ åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
â¬œ è¿æ¥æ± é…ç½®
â¬œ è¯»å†™åˆ†ç¦»å‡†å¤‡
```

**ä¼˜åŒ–é‡ç‚¹**:
```sql
-- æ·»åŠ å¤åˆç´¢å¼•
CREATE INDEX idx_orders_user_status ON orders(user_id, status, created_at);
CREATE INDEX idx_players_game_status ON players(game_id, status, rating);

-- ä¼˜åŒ–ç»Ÿè®¡æŸ¥è¯¢
-- ä½¿ç”¨ç‰©åŒ–è§†å›¾æˆ–å®šæ—¶ç»Ÿè®¡è¡¨
```

#### Day 6-7: ç›‘æ§ä¸å‘Šè­¦
```go
// internal/metrics/metrics.go
â¬œ å®ç°PrometheusæŒ‡æ ‡æ”¶é›†
â¬œ APIå“åº”æ—¶é—´ç›‘æ§
â¬œ é”™è¯¯ç‡ç›‘æ§
â¬œ æ•°æ®åº“è¿æ¥æ± ç›‘æ§
â¬œ Redisè¿æ¥ç›‘æ§
â¬œ WebSocketè¿æ¥æ•°ç›‘æ§

// internal/alert/alert.go
â¬œ å®ç°å‘Šè­¦è§„åˆ™
â¬œ é‚®ä»¶å‘Šè­¦
â¬œ é’‰é’‰/ä¼ä¸šå¾®ä¿¡å‘Šè­¦
â¬œ å‘Šè­¦èšåˆ
```

**ç›‘æ§æŒ‡æ ‡**:
```
1. ç³»ç»ŸæŒ‡æ ‡
   - CPUä½¿ç”¨ç‡
   - å†…å­˜ä½¿ç”¨ç‡
   - ç£ç›˜ä½¿ç”¨ç‡
   
2. åº”ç”¨æŒ‡æ ‡
   - QPS
   - å“åº”æ—¶é—´
   - é”™è¯¯ç‡
   - å¹¶å‘è¿æ¥æ•°
   
3. ä¸šåŠ¡æŒ‡æ ‡
   - è®¢å•é‡
   - æ”¯ä»˜æˆåŠŸç‡
   - ç”¨æˆ·æ´»è·ƒåº¦
```

### âœ… éªŒæ”¶æ ‡å‡†
- [ ] ç¼“å­˜å‘½ä¸­ç‡ â‰¥ 80%
- [ ] APIå¹³å‡å“åº”æ—¶é—´ < 200ms
- [ ] æ•°æ®åº“æ…¢æŸ¥è¯¢ä¼˜åŒ–å®Œæˆ
- [ ] ç›‘æ§ç³»ç»Ÿæ­£å¸¸è¿è¡Œ
- [ ] å‘Šè­¦è§„åˆ™é…ç½®å®Œæˆ

---

## ğŸ“Š æ€»ä½“éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§
- [ ] ä¸‰ç«¯åŠŸèƒ½å®Œæ•´åº¦ â‰¥ 95%
- [ ] æ ¸å¿ƒä¸šåŠ¡æµç¨‹å®Œæ•´
- [ ] æ‰€æœ‰APIæ–‡æ¡£å®Œå–„

### ä»£ç è´¨é‡
- [ ] æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç è§„èŒƒæ£€æŸ¥é€šè¿‡
- [ ] æ— ä¸¥é‡å®‰å…¨æ¼æ´

### æ€§èƒ½æŒ‡æ ‡
- [ ] APIå“åº”æ—¶é—´ < 200ms (P95)
- [ ] æ”¯æŒ1000+å¹¶å‘ç”¨æˆ·
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–å®Œæˆ
- [ ] ç¼“å­˜ç­–ç•¥æœ‰æ•ˆ

### å®‰å…¨æ€§
- [ ] CSRFä¿æŠ¤å®Œæˆ
- [ ] APIé™æµå®Œæˆ
- [ ] æ–‡ä»¶ä¸Šä¼ å®‰å…¨
- [ ] æ‰€æœ‰è¾“å…¥éªŒè¯

### æ–‡æ¡£
- [ ] APIæ–‡æ¡£å®Œæ•´
- [ ] éƒ¨ç½²æ–‡æ¡£å®Œæ•´
- [ ] è¿ç»´æ–‡æ¡£å®Œæ•´
- [ ] å¼€å‘æ–‡æ¡£å®Œæ•´

---

## ğŸ¯ æœ€ç»ˆç›®æ ‡

**é¡¹ç›®è¯„çº§**: B+ â†’ A
**åŠŸèƒ½å®Œæ•´åº¦**: 75% â†’ 95%
**æµ‹è¯•è¦†ç›–ç‡**: 65.66% â†’ 80%+
**å¯ä¸Šçº¿çŠ¶æ€**: âœ… å®Œå…¨å°±ç»ª

---

## ğŸ’¡ å¼€å‘å»ºè®®

1. **æ¯å¤©æäº¤ä»£ç ** - ä¿æŒå°æ­¥å¿«è·‘
2. **å…ˆå†™æµ‹è¯•** - TDDå¼€å‘æ¨¡å¼
3. **åŠæ—¶æ–‡æ¡£** - ä»£ç å³æ–‡æ¡£
4. **ä»£ç å®¡æŸ¥** - ä¿è¯è´¨é‡
5. **æŒç»­é›†æˆ** - è‡ªåŠ¨åŒ–æµ‹è¯•

---

## ğŸ“ éœ€è¦æ”¯æŒ

å¦‚éœ€è¦æˆ‘å¸®åŠ©ï¼š
1. âœ… åˆ›å»ºå…·ä½“çš„ä»£ç æ–‡ä»¶
2. âœ… å®ç°æŸä¸ªåŠŸèƒ½æ¨¡å—
3. âœ… ç¼–å†™æµ‹è¯•ç”¨ä¾‹
4. âœ… ä¼˜åŒ–æ€§èƒ½
5. âœ… è§£å†³æŠ€æœ¯é—®é¢˜

éšæ—¶å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šç«‹å³å¼€å§‹ï¼
